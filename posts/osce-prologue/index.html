<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>OSCE Prologue or How to get Secret key to CTP? | .burso | blog about ctf & anything else</title><meta name=keywords content="offensive-security,hacking,ctf"><meta name=description content="If you want to register to CTP, you will need something they call Registration Code and Secret Key. So firstly, there is interesting file /fc4.js
function fc4me(srvstr) {   if(!document.pleazfc4me.email.value || !document.pleazfc4me.securitystring.value) {  alert(&#34;Please fill in all the required fields!&#34;);  return false;  }  if(document.pleazfc4me.securitystring.value != hexMD5(&#34;\x74\x72\x79\x68\x61\x72\x64\x65\x72&#34;+srvstr)) {  alert(&#34;Registration Authorization String not accepted! Try Harder! &#34;);  return false;  } else {  document.pleazfc4me.submit();  }  } So all you need to do is setup some js variables in browser console and call fc4me(srvstr)"><meta name=author content="Matus Bursa"><link rel=canonical href=https://www.burso.eu/posts/osce-prologue/><link crossorigin=anonymous href=/assets/css/stylesheet.min.b4e19c453811e60acfec1f00c15ac2be1c53f6ab90187e684358ce7faaf48bab.css integrity="sha256-tOGcRTgR5grP7B8AwVrCvhxT9quQGH5oQ1jOf6r0i6s=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.burso.eu/img/hacked.png><link rel=icon type=image/png sizes=16x16 href=https://www.burso.eu/img/hacked.png><link rel=icon type=image/png sizes=32x32 href=https://www.burso.eu/img/hacked.png><link rel=apple-touch-icon href=https://www.burso.eu/img/hacked.png><link rel=mask-icon href=https://www.burso.eu/img/hacked.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="OSCE Prologue or How to get Secret key to CTP?"><meta property="og:description" content="If you want to register to CTP, you will need something they call Registration Code and Secret Key. So firstly, there is interesting file /fc4.js
function fc4me(srvstr) {   if(!document.pleazfc4me.email.value || !document.pleazfc4me.securitystring.value) {  alert(&#34;Please fill in all the required fields!&#34;);  return false;  }  if(document.pleazfc4me.securitystring.value != hexMD5(&#34;\x74\x72\x79\x68\x61\x72\x64\x65\x72&#34;+srvstr)) {  alert(&#34;Registration Authorization String not accepted! Try Harder! &#34;);  return false;  } else {  document.pleazfc4me.submit();  }  } So all you need to do is setup some js variables in browser console and call fc4me(srvstr)"><meta property="og:type" content="article"><meta property="og:url" content="https://www.burso.eu/posts/osce-prologue/"><meta property="og:image" content="https://www.burso.eu/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-01-22T14:32:59+01:00"><meta property="article:modified_time" content="2020-01-22T14:32:59+01:00"><meta property="og:site_name" content=".burso"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.burso.eu/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="OSCE Prologue or How to get Secret key to CTP?"><meta name=twitter:description content="If you want to register to CTP, you will need something they call Registration Code and Secret Key. So firstly, there is interesting file /fc4.js
function fc4me(srvstr) {   if(!document.pleazfc4me.email.value || !document.pleazfc4me.securitystring.value) {  alert(&#34;Please fill in all the required fields!&#34;);  return false;  }  if(document.pleazfc4me.securitystring.value != hexMD5(&#34;\x74\x72\x79\x68\x61\x72\x64\x65\x72&#34;+srvstr)) {  alert(&#34;Registration Authorization String not accepted! Try Harder! &#34;);  return false;  } else {  document.pleazfc4me.submit();  }  } So all you need to do is setup some js variables in browser console and call fc4me(srvstr)"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://www.burso.eu/posts/"},{"@type":"ListItem","position":3,"name":"OSCE Prologue or How to get Secret key to CTP?","item":"https://www.burso.eu/posts/osce-prologue/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"OSCE Prologue or How to get Secret key to CTP?","name":"OSCE Prologue or How to get Secret key to CTP?","description":"If you want to register to CTP, you will need something they call Registration Code and Secret Key. So firstly, there is interesting file /fc4.js\nfunction fc4me(srvstr) {   if(!document.pleazfc4me.email.value || !document.pleazfc4me.securitystring.value) {  alert(\u0026#34;Please fill in all the required fields!\u0026#34;);  return false;  }  if(document.pleazfc4me.securitystring.value != hexMD5(\u0026#34;\\x74\\x72\\x79\\x68\\x61\\x72\\x64\\x65\\x72\u0026#34;+srvstr)) {  alert(\u0026#34;Registration Authorization String not accepted! Try Harder! \u0026#34;);  return false;  } else {  document.pleazfc4me.submit();  }  } So all you need to do is setup some js variables in browser console and call fc4me(srvstr)","keywords":["offensive-security","hacking","ctf"],"articleBody":"If you want to register to CTP, you will need something they call Registration Code and Secret Key. So firstly, there is interesting file /fc4.js\nfunction fc4me(srvstr) {   if(!document.pleazfc4me.email.value || !document.pleazfc4me.securitystring.value) {  alert(\"Please fill in all the required fields!\");  return false;  }  if(document.pleazfc4me.securitystring.value != hexMD5(\"\\x74\\x72\\x79\\x68\\x61\\x72\\x64\\x65\\x72\"+srvstr)) {  alert(\"Registration Authorization String not accepted! Try Harder! \");  return false;  } else {  document.pleazfc4me.submit();  }  } So all you need to do is setup some js variables in browser console and call fc4me(srvstr)\nvar srvstr='Thursday 23rd of January 2020'; document.pleazfc4me.securitystring.value=hexMD5(\"\\x74\\x72\\x79\\x68\\x61\\x72\\x64\\x65\\x72\"+srvstr); document.pleazfc4me.email.value=\"\"; fc4me(srvstr); After that you will obtain something like this:\nRW1haWw6IDx5b3VyX2VtYWlsX2FkZHJlc3M+ICwgUmVnaXN0cmF0aW9uIENvZGU6IDx5b3VyX3Jl Z2lzdHJhdGlvbl9udW1iZXI+IHwgTm93IGRlY29kZSB5b3VyIENUUCBTZWNyZXQgS2V5IGFuZCB5 b3UgYXJlIGRvbmUhIDogXHgzMVx4QzBceDUwXHg2OFx4MjRceDc3XHg3NVx4NzFceDY4XHg3NVx4 MjNceDc5XHgyMFx4NjhceDc4XHg3Nlx4MjRceDI1XHg2OFx4NzVceDc2XHgyMlx4MjNceDY4XHg3 N1x4NzdceDc2XHg3NVx4NjhceDc1XHgyNFx4MjVceDc0XHg2OFx4MjdceDI3XHgyMFx4MjJceDY4 XHgyNFx4NzRceDIzXHgyM1x4NjhceDIwXHg3M1x4NzFceDIwXHg2OFx4NzBceDczXHg3OVx4Nzdc eDY4XHg3OFx4NzZceDIzXHgyMFx4NjhceDc2XHgyNVx4MjVceDIyXHg2OFx4NzJceDczXHgyN1x4 NzRceDY4XHgyN1x4NzBceDc1XHg3NVx4NjhceDIwXHgyNFx4MjRceDI3XHg2OFx4NzlceDcyXHg3 Nlx4NzVceDY4XHg3N1x4NzNceDc5XHgyN1x4NjhceDI0XHgyMFx4NzRceDc3XHg2OFx4MjdceDIw XHg3NFx4MjJceDY4XHgyNVx4NzdceDIwXHg3OFx4NjhceDc1XHg3Mlx4NzlceDc0XHg2OFx4NzVc eDI0XHgyM1x4NzJceDY4XHg3Nlx4MjdceDI0XHgyNFx4NjhceDIyXHg3OVx4NzdceDczXHg2OFx4 NzRceDc5XHg3OFx4MjBceDY4XHgyNVx4MjVceDc2XHg3NFx4NjhceDI1XHg3NFx4NzFceDc2XHg2 OFx4MjdceDc1XHgyM1x4MjNceDY4XHgyNFx4MjJceDIwXHg3N1x4NjhceDIyXHgyNVx4NzNceDc4 XHg2OFx4NzNceDIzXHg3NVx4NzZceDY4XHg3M1x4NzNceDc1XHgyNVx4NTRceDVFXHg4Qlx4RkVc eDhCXHhEN1x4RkNceEI5XHg4MFx4MDBceDAwXHgwMFx4QkJceDQxXHgwMFx4MDBceDAwXHgzMVx4 QzBceDUwXHhBQ1x4MzNceEMzXHhBQVx4RTJceEZBXHg1NFx4NUVceEND Looks like BASE64 encoded text, so we can copy text to file and try to decode it.\n$ cat encoded_raw | base64 -d Email:  , Registration Code:  | Now decode your CTP Secret Key and you are done! : \\x31\\xC0\\x50\\x68\\x24\\x77\\x75\\x71\\x68\\x75\\x23\\x79\\x20\\x68\\x78\\x76\\x24\\x25\\x68 \\x75\\x76\\x22\\x23\\x68\\x77\\x77\\x76\\x75\\x68\\x75\\x24\\x25\\x74\\x68\\x27\\x27\\x20\\x22 \\x68\\x24\\x74\\x23\\x23\\x68\\x20\\x73\\x71\\x20\\x68\\x70\\x73\\x79\\x77\\x68\\x78\\x76\\x23 \\x20\\x68\\x76\\x25\\x25\\x22\\x68\\x72\\x73\\x27\\x74\\x68\\x27\\x70\\x75\\x75\\x68\\x20\\x24 \\x24\\x27\\x68\\x79\\x72\\x76\\x75\\x68\\x77\\x73\\x79\\x27\\x68\\x24\\x20\\x74\\x77\\x68\\x27 \\x20\\x74\\x22\\x68\\x25\\x77\\x20\\x78\\x68\\x75\\x72\\x79\\x74\\x68\\x75\\x24\\x23\\x72\\x68 \\x76\\x27\\x24\\x24\\x68\\x22\\x79\\x77\\x73\\x68\\x74\\x79\\x78\\x20\\x68\\x25\\x25\\x76\\x74 \\x68\\x25\\x74\\x71\\x76\\x68\\x27\\x75\\x23\\x23\\x68\\x24\\x22\\x20\\x77\\x68\\x22\\x25\\x73 \\x78\\x68\\x73\\x23\\x75\\x76\\x68\\x73\\x73\\x75\\x25\\x54\\x5E\\x8B\\xFE\\x8B\\xD7\\xFC\\xB9 \\x80\\x00\\x00\\x00\\xBB\\x41\\x00\\x00\\x00\\x31\\xC0\\x50\\xAC\\x33\\xC3\\xAA\\xE2\\xFA\\x54 \\x5E\\xCC It is something like binary blob, let’s search it. After searching we can think about shellcode. So let’s save it to file.\n$ python -c 'import sys; sys.stdout.buffer.write(b\"\\x31\\xC0\\x50\\x68\\x24\\x77\\x75\\x71\\x68\\x75\\x23\\x79\\x20\\x68\\x78\\x76\\x24\\x25\\x68\\x75\\x76\\x22\\x23\\x68\\x77\\x77\\x76\\x75\\x68\\x75\\x24\\x25\\x74\\x68\\x27\\x27\\x20\\x22\\x68\\x24\\x74\\x23\\x23\\x68\\x20\\x73\\x71\\x20\\x68\\x70\\x73\\x79\\x77\\x68\\x78\\x76\\x23\\x20\\x68\\x76\\x25\\x25\\x22\\x68\\x72\\x73\\x27\\x74\\x68\\x27\\x70\\x75\\x75\\x68\\x20\\x24\\x24\\x27\\x68\\x79\\x72\\x76\\x75\\x68\\x77\\x73\\x79\\x27\\x68\\x24\\x20\\x74\\x77\\x68\\x27\\x20\\x74\\x22\\x68\\x25\\x77\\x20\\x78\\x68\\x75\\x72\\x79\\x74\\x68\\x75\\x24\\x23\\x72\\x68\\x76\\x27\\x24\\x24\\x68\\x22\\x79\\x77\\x73\\x68\\x74\\x79\\x78\\x20\\x68\\x25\\x25\\x76\\x74\\x68\\x25\\x74\\x71\\x76\\x68\\x27\\x75\\x23\\x23\\x68\\x24\\x22\\x20\\x77\\x68\\x22\\x25\\x73\\x78\\x68\\x73\\x23\\x75\\x76\\x68\\x73\\x73\\x75\\x25\\x54\\x5E\\x8B\\xFE\\x8B\\xD7\\xFC\\xB9\\x80\\x00\\x00\\x00\\xBB\\x41\\x00\\x00\\x00\\x31\\xC0\\x50\\xAC\\x33\\xC3\\xAA\\xE2\\xFA\\x54\\x5E\\xCC\")'  shellcode $ ndisasm -b 32 shellcode  shellcode.asm $ cat shellcode.asm 00000000 31C0 xor eax,eax 00000002 50 push eax 00000003 6824777571 push dword 0x71757724 00000008 6875237920 push dword 0x20792375 0000000D 6878762425 push dword 0x25247678 00000012 6875762223 push dword 0x23227675 00000017 6877777675 push dword 0x75767777 0000001C 6875242574 push dword 0x74252475 00000021 6827272022 push dword 0x22202727 00000026 6824742323 push dword 0x23237424 0000002B 6820737120 push dword 0x20717320 00000030 6870737977 push dword 0x77797370 00000035 6878762320 push dword 0x20237678 0000003A 6876252522 push dword 0x22252576 0000003F 6872732774 push dword 0x74277372 00000044 6827707575 push dword 0x75757027 00000049 6820242427 push dword 0x27242420 0000004E 6879727675 push dword 0x75767279 00000053 6877737927 push dword 0x27797377 00000058 6824207477 push dword 0x77742024 0000005D 6827207422 push dword 0x22742027 00000062 6825772078 push dword 0x78207725 00000067 6875727974 push dword 0x74797275 0000006C 6875242372 push dword 0x72232475 00000071 6876272424 push dword 0x24242776 00000076 6822797773 push dword 0x73777922 0000007B 6874797820 push dword 0x20787974 00000080 6825257674 push dword 0x74762525 00000085 6825747176 push dword 0x76717425 0000008A 6827752323 push dword 0x23237527 0000008F 6824222077 push dword 0x77202224 00000094 6822257378 push dword 0x78732522 00000099 6873237576 push dword 0x76752373 0000009E 6873737525 push dword 0x25757373 000000A3 54 push esp 000000A4 5E pop esi 000000A5 8BFE mov edi,esi 000000A7 8BD7 mov edx,edi 000000A9 FC cld 000000AA B980000000 mov ecx,0x80 000000AF BB41000000 mov ebx,0x41 000000B4 31C0 xor eax,eax 000000B6 50 push eax 000000B7 AC lodsb 000000B8 33C3 xor eax,ebx 000000BA AA stosb 000000BB E2FA loop 0xb7 000000BD 54 push esp 000000BE 5E pop esi 000000BF CC int3 Now we have to edit the file before we can assemble it.\n$ awk '{$1=$2=\"\"; print $0}' shellcode.asm | sed 's/^ //g'  shellcode_edited.asm Save diff to patch file shellcode.patch\n--- shellcode.asm\t2020-01-23 12:29:31.345434907 +0100 +++ shellcode_diff.asm\t2020-01-23 12:28:09.689429680 +0100 @@ -1,3 +1,5 @@ +global _start +_start:  xor eax,eax  push eax  push dword 0x71757724 @@ -41,10 +43,11 @@  mov ebx,0x41  xor eax,eax  push eax +decode:  lodsb  xor eax,ebx  stosb -loop 0xb7 +loop decode  push esp  pop esi  int3 And apply the following patch. Then we can assemble it.\n$ patch $ nasm -f elf shellcode.asm $ ld -m elf_i386 -o key_ed shellcode.o Finally let’s find the secret key!\n$ gdb ./key_ed $(gdb) r $(gdb) x/s $edx 0xffffdbec:\t\"224d2b47cd29eca6f4bbd507dd75589ac8627fee4eb34385d6a9fa5cea56628f8374aeeff14432f57ddc97ba1286a20ae5bbffac4ed5667447cb97ed4b8ae640\" ","wordCount":"552","inLanguage":"en","datePublished":"2020-01-22T14:32:59+01:00","dateModified":"2020-01-22T14:32:59+01:00","author":{"@type":"Person","name":"Matus Bursa"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.burso.eu/posts/osce-prologue/"},"publisher":{"@type":"Organization","name":".burso | blog about ctf \u0026 anything else","logo":{"@type":"ImageObject","url":"https://www.burso.eu/img/hacked.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.burso.eu accesskey=h title="/ (Alt + H)"><img src=https://www.burso.eu/img/hacked.png alt=logo aria-label=logo height=35>/</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://www.burso.eu/archives/ title=archives><span>archives</span></a></li><li><a href=https://www.burso.eu/categories/ title=categories><span>categories</span></a></li><li><a href=https://www.burso.eu/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://www.burso.eu/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://www.burso.eu>Home</a>&nbsp;»&nbsp;<a href=https://www.burso.eu/posts/>Posts</a></div><h1 class=post-title>OSCE Prologue or How to get Secret key to CTP?</h1><div class=post-meta><span title="2020-01-22 14:32:59 +0100 CET">January 22, 2020</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Matus Bursa&nbsp;|&nbsp;<a href=https://github.com/matusso/website/content/posts/osce-prologue.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>If you want to register to CTP, you will need something they call Registration Code and Secret Key. So firstly, there is interesting file <strong>/fc4.js</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>fc4me</span>(<span style=color:#a6e22e>srvstr</span>) {
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span>document.<span style=color:#a6e22e>pleazfc4me</span>.<span style=color:#a6e22e>email</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>||</span> <span style=color:#f92672>!</span>document.<span style=color:#a6e22e>pleazfc4me</span>.<span style=color:#a6e22e>securitystring</span>.<span style=color:#a6e22e>value</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>alert</span>(<span style=color:#e6db74>&#34;Please fill in all the required fields!&#34;</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>if</span>(document.<span style=color:#a6e22e>pleazfc4me</span>.<span style=color:#a6e22e>securitystring</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>!=</span> <span style=color:#a6e22e>hexMD5</span>(<span style=color:#e6db74>&#34;\x74\x72\x79\x68\x61\x72\x64\x65\x72&#34;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>srvstr</span>)) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>alert</span>(<span style=color:#e6db74>&#34;Registration Authorization String not accepted! Try Harder! &#34;</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      document.<span style=color:#a6e22e>pleazfc4me</span>.<span style=color:#a6e22e>submit</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>   
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>So all you need to do is setup some js variables in browser console and call <strong>fc4me(srvstr)</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>srvstr</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Thursday 23rd of January 2020&#39;</span>;
</span></span><span style=display:flex><span>document.<span style=color:#a6e22e>pleazfc4me</span>.<span style=color:#a6e22e>securitystring</span>.<span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#a6e22e>hexMD5</span>(<span style=color:#e6db74>&#34;\x74\x72\x79\x68\x61\x72\x64\x65\x72&#34;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>srvstr</span>);
</span></span><span style=display:flex><span>document.<span style=color:#a6e22e>pleazfc4me</span>.<span style=color:#a6e22e>email</span>.<span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&lt;your_email_address&gt;&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>fc4me</span>(<span style=color:#a6e22e>srvstr</span>);
</span></span></code></pre></div><p>After that you will obtain something like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>RW1haWw6IDx5b3VyX2VtYWlsX2FkZHJlc3M+ICwgUmVnaXN0cmF0aW9uIENvZGU6IDx5b3VyX3Jl
</span></span><span style=display:flex><span>Z2lzdHJhdGlvbl9udW1iZXI+IHwgTm93IGRlY29kZSB5b3VyIENUUCBTZWNyZXQgS2V5IGFuZCB5
</span></span><span style=display:flex><span>b3UgYXJlIGRvbmUhIDogXHgzMVx4QzBceDUwXHg2OFx4MjRceDc3XHg3NVx4NzFceDY4XHg3NVx4
</span></span><span style=display:flex><span>MjNceDc5XHgyMFx4NjhceDc4XHg3Nlx4MjRceDI1XHg2OFx4NzVceDc2XHgyMlx4MjNceDY4XHg3
</span></span><span style=display:flex><span>N1x4NzdceDc2XHg3NVx4NjhceDc1XHgyNFx4MjVceDc0XHg2OFx4MjdceDI3XHgyMFx4MjJceDY4
</span></span><span style=display:flex><span>XHgyNFx4NzRceDIzXHgyM1x4NjhceDIwXHg3M1x4NzFceDIwXHg2OFx4NzBceDczXHg3OVx4Nzdc
</span></span><span style=display:flex><span>eDY4XHg3OFx4NzZceDIzXHgyMFx4NjhceDc2XHgyNVx4MjVceDIyXHg2OFx4NzJceDczXHgyN1x4
</span></span><span style=display:flex><span>NzRceDY4XHgyN1x4NzBceDc1XHg3NVx4NjhceDIwXHgyNFx4MjRceDI3XHg2OFx4NzlceDcyXHg3
</span></span><span style=display:flex><span>Nlx4NzVceDY4XHg3N1x4NzNceDc5XHgyN1x4NjhceDI0XHgyMFx4NzRceDc3XHg2OFx4MjdceDIw
</span></span><span style=display:flex><span>XHg3NFx4MjJceDY4XHgyNVx4NzdceDIwXHg3OFx4NjhceDc1XHg3Mlx4NzlceDc0XHg2OFx4NzVc
</span></span><span style=display:flex><span>eDI0XHgyM1x4NzJceDY4XHg3Nlx4MjdceDI0XHgyNFx4NjhceDIyXHg3OVx4NzdceDczXHg2OFx4
</span></span><span style=display:flex><span>NzRceDc5XHg3OFx4MjBceDY4XHgyNVx4MjVceDc2XHg3NFx4NjhceDI1XHg3NFx4NzFceDc2XHg2
</span></span><span style=display:flex><span>OFx4MjdceDc1XHgyM1x4MjNceDY4XHgyNFx4MjJceDIwXHg3N1x4NjhceDIyXHgyNVx4NzNceDc4
</span></span><span style=display:flex><span>XHg2OFx4NzNceDIzXHg3NVx4NzZceDY4XHg3M1x4NzNceDc1XHgyNVx4NTRceDVFXHg4Qlx4RkVc
</span></span><span style=display:flex><span>eDhCXHhEN1x4RkNceEI5XHg4MFx4MDBceDAwXHgwMFx4QkJceDQxXHgwMFx4MDBceDAwXHgzMVx4
</span></span><span style=display:flex><span>QzBceDUwXHhBQ1x4MzNceEMzXHhBQVx4RTJceEZBXHg1NFx4NUVceEND
</span></span></code></pre></div><p>Looks like <strong>BASE64</strong> encoded text, so we can copy text to file and try to decode it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cat encoded_raw | base64 -d
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Email: &lt;your_email_address&gt; , Registration Code: &lt;your_registration_number&gt; | 
</span></span><span style=display:flex><span>Now decode your CTP Secret Key and you are <span style=color:#66d9ef>done</span>! : 
</span></span><span style=display:flex><span><span style=color:#ae81ff>\x</span>31<span style=color:#ae81ff>\x</span>C0<span style=color:#ae81ff>\x</span>50<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>24<span style=color:#ae81ff>\x</span>77<span style=color:#ae81ff>\x</span>75<span style=color:#ae81ff>\x</span>71<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>75<span style=color:#ae81ff>\x</span>23<span style=color:#ae81ff>\x</span>79<span style=color:#ae81ff>\x</span>20<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>78<span style=color:#ae81ff>\x</span>76<span style=color:#ae81ff>\x</span>24<span style=color:#ae81ff>\x</span>25<span style=color:#ae81ff>\x</span><span style=color:#ae81ff>68</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>\x</span>75<span style=color:#ae81ff>\x</span>76<span style=color:#ae81ff>\x</span>22<span style=color:#ae81ff>\x</span>23<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>77<span style=color:#ae81ff>\x</span>77<span style=color:#ae81ff>\x</span>76<span style=color:#ae81ff>\x</span>75<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>75<span style=color:#ae81ff>\x</span>24<span style=color:#ae81ff>\x</span>25<span style=color:#ae81ff>\x</span>74<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>27<span style=color:#ae81ff>\x</span>27<span style=color:#ae81ff>\x</span>20<span style=color:#ae81ff>\x</span><span style=color:#ae81ff>22</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>24<span style=color:#ae81ff>\x</span>74<span style=color:#ae81ff>\x</span>23<span style=color:#ae81ff>\x</span>23<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>20<span style=color:#ae81ff>\x</span>73<span style=color:#ae81ff>\x</span>71<span style=color:#ae81ff>\x</span>20<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>70<span style=color:#ae81ff>\x</span>73<span style=color:#ae81ff>\x</span>79<span style=color:#ae81ff>\x</span>77<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>78<span style=color:#ae81ff>\x</span>76<span style=color:#ae81ff>\x</span><span style=color:#ae81ff>23</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>\x</span>20<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>76<span style=color:#ae81ff>\x</span>25<span style=color:#ae81ff>\x</span>25<span style=color:#ae81ff>\x</span>22<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>72<span style=color:#ae81ff>\x</span>73<span style=color:#ae81ff>\x</span>27<span style=color:#ae81ff>\x</span>74<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>27<span style=color:#ae81ff>\x</span>70<span style=color:#ae81ff>\x</span>75<span style=color:#ae81ff>\x</span>75<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>20<span style=color:#ae81ff>\x</span><span style=color:#ae81ff>24</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>\x</span>24<span style=color:#ae81ff>\x</span>27<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>79<span style=color:#ae81ff>\x</span>72<span style=color:#ae81ff>\x</span>76<span style=color:#ae81ff>\x</span>75<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>77<span style=color:#ae81ff>\x</span>73<span style=color:#ae81ff>\x</span>79<span style=color:#ae81ff>\x</span>27<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>24<span style=color:#ae81ff>\x</span>20<span style=color:#ae81ff>\x</span>74<span style=color:#ae81ff>\x</span>77<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span><span style=color:#ae81ff>27</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>\x</span>20<span style=color:#ae81ff>\x</span>74<span style=color:#ae81ff>\x</span>22<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>25<span style=color:#ae81ff>\x</span>77<span style=color:#ae81ff>\x</span>20<span style=color:#ae81ff>\x</span>78<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>75<span style=color:#ae81ff>\x</span>72<span style=color:#ae81ff>\x</span>79<span style=color:#ae81ff>\x</span>74<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>75<span style=color:#ae81ff>\x</span>24<span style=color:#ae81ff>\x</span>23<span style=color:#ae81ff>\x</span>72<span style=color:#ae81ff>\x</span><span style=color:#ae81ff>68</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>\x</span>76<span style=color:#ae81ff>\x</span>27<span style=color:#ae81ff>\x</span>24<span style=color:#ae81ff>\x</span>24<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>22<span style=color:#ae81ff>\x</span>79<span style=color:#ae81ff>\x</span>77<span style=color:#ae81ff>\x</span>73<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>74<span style=color:#ae81ff>\x</span>79<span style=color:#ae81ff>\x</span>78<span style=color:#ae81ff>\x</span>20<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>25<span style=color:#ae81ff>\x</span>25<span style=color:#ae81ff>\x</span>76<span style=color:#ae81ff>\x</span><span style=color:#ae81ff>74</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>25<span style=color:#ae81ff>\x</span>74<span style=color:#ae81ff>\x</span>71<span style=color:#ae81ff>\x</span>76<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>27<span style=color:#ae81ff>\x</span>75<span style=color:#ae81ff>\x</span>23<span style=color:#ae81ff>\x</span>23<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>24<span style=color:#ae81ff>\x</span>22<span style=color:#ae81ff>\x</span>20<span style=color:#ae81ff>\x</span>77<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>22<span style=color:#ae81ff>\x</span>25<span style=color:#ae81ff>\x</span><span style=color:#ae81ff>73</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>\x</span>78<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>73<span style=color:#ae81ff>\x</span>23<span style=color:#ae81ff>\x</span>75<span style=color:#ae81ff>\x</span>76<span style=color:#ae81ff>\x</span>68<span style=color:#ae81ff>\x</span>73<span style=color:#ae81ff>\x</span>73<span style=color:#ae81ff>\x</span>75<span style=color:#ae81ff>\x</span>25<span style=color:#ae81ff>\x</span>54<span style=color:#ae81ff>\x</span>5E<span style=color:#ae81ff>\x</span>8B<span style=color:#ae81ff>\x</span>FE<span style=color:#ae81ff>\x</span>8B<span style=color:#ae81ff>\x</span>D7<span style=color:#ae81ff>\x</span>FC<span style=color:#ae81ff>\x</span>B9
</span></span><span style=display:flex><span><span style=color:#ae81ff>\x</span>80<span style=color:#ae81ff>\x</span>00<span style=color:#ae81ff>\x</span>00<span style=color:#ae81ff>\x</span>00<span style=color:#ae81ff>\x</span>BB<span style=color:#ae81ff>\x</span>41<span style=color:#ae81ff>\x</span>00<span style=color:#ae81ff>\x</span>00<span style=color:#ae81ff>\x</span>00<span style=color:#ae81ff>\x</span>31<span style=color:#ae81ff>\x</span>C0<span style=color:#ae81ff>\x</span>50<span style=color:#ae81ff>\x</span>AC<span style=color:#ae81ff>\x</span>33<span style=color:#ae81ff>\x</span>C3<span style=color:#ae81ff>\x</span>AA<span style=color:#ae81ff>\x</span>E2<span style=color:#ae81ff>\x</span>FA<span style=color:#ae81ff>\x</span><span style=color:#ae81ff>54</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>\x</span>5E<span style=color:#ae81ff>\x</span>CC
</span></span></code></pre></div><p>It is something like binary blob, let&rsquo;s <a href="https://duckduckgo.com/?q=%5Cx31%5Cxc0">search it</a>.
After searching we can think about <strong>shellcode</strong>. So let&rsquo;s save it to file.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ python -c <span style=color:#e6db74>&#39;import sys; sys.stdout.buffer.write(b&#34;\x31\xC0\x50\x68\x24\x77\x75\x71\x68\x75\x23\x79\x20\x68\x78\x76\x24\x25\x68\x75\x76\x22\x23\x68\x77\x77\x76\x75\x68\x75\x24\x25\x74\x68\x27\x27\x20\x22\x68\x24\x74\x23\x23\x68\x20\x73\x71\x20\x68\x70\x73\x79\x77\x68\x78\x76\x23\x20\x68\x76\x25\x25\x22\x68\x72\x73\x27\x74\x68\x27\x70\x75\x75\x68\x20\x24\x24\x27\x68\x79\x72\x76\x75\x68\x77\x73\x79\x27\x68\x24\x20\x74\x77\x68\x27\x20\x74\x22\x68\x25\x77\x20\x78\x68\x75\x72\x79\x74\x68\x75\x24\x23\x72\x68\x76\x27\x24\x24\x68\x22\x79\x77\x73\x68\x74\x79\x78\x20\x68\x25\x25\x76\x74\x68\x25\x74\x71\x76\x68\x27\x75\x23\x23\x68\x24\x22\x20\x77\x68\x22\x25\x73\x78\x68\x73\x23\x75\x76\x68\x73\x73\x75\x25\x54\x5E\x8B\xFE\x8B\xD7\xFC\xB9\x80\x00\x00\x00\xBB\x41\x00\x00\x00\x31\xC0\x50\xAC\x33\xC3\xAA\xE2\xFA\x54\x5E\xCC&#34;)&#39;</span> &gt; shellcode
</span></span><span style=display:flex><span>$ ndisasm -b <span style=color:#ae81ff>32</span> shellcode &gt; shellcode.asm
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cat shellcode.asm
</span></span><span style=display:flex><span><span style=color:#ae81ff>00000000</span>  31C0              xor eax,eax
</span></span><span style=display:flex><span><span style=color:#ae81ff>00000002</span>  <span style=color:#ae81ff>50</span>                push eax
</span></span><span style=display:flex><span><span style=color:#ae81ff>00000003</span>  <span style=color:#ae81ff>6824777571</span>        push dword 0x71757724
</span></span><span style=display:flex><span><span style=color:#ae81ff>00000008</span>  <span style=color:#ae81ff>6875237920</span>        push dword 0x20792375
</span></span><span style=display:flex><span>0000000D  <span style=color:#ae81ff>6878762425</span>        push dword 0x25247678
</span></span><span style=display:flex><span><span style=color:#ae81ff>00000012</span>  <span style=color:#ae81ff>6875762223</span>        push dword 0x23227675
</span></span><span style=display:flex><span><span style=color:#ae81ff>00000017</span>  <span style=color:#ae81ff>6877777675</span>        push dword 0x75767777
</span></span><span style=display:flex><span>0000001C  <span style=color:#ae81ff>6875242574</span>        push dword 0x74252475
</span></span><span style=display:flex><span><span style=color:#ae81ff>00000021</span>  <span style=color:#ae81ff>6827272022</span>        push dword 0x22202727
</span></span><span style=display:flex><span><span style=color:#ae81ff>00000026</span>  <span style=color:#ae81ff>6824742323</span>        push dword 0x23237424
</span></span><span style=display:flex><span>0000002B  <span style=color:#ae81ff>6820737120</span>        push dword 0x20717320
</span></span><span style=display:flex><span><span style=color:#ae81ff>00000030</span>  <span style=color:#ae81ff>6870737977</span>        push dword 0x77797370
</span></span><span style=display:flex><span><span style=color:#ae81ff>00000035</span>  <span style=color:#ae81ff>6878762320</span>        push dword 0x20237678
</span></span><span style=display:flex><span>0000003A  <span style=color:#ae81ff>6876252522</span>        push dword 0x22252576
</span></span><span style=display:flex><span>0000003F  <span style=color:#ae81ff>6872732774</span>        push dword 0x74277372
</span></span><span style=display:flex><span><span style=color:#ae81ff>00000044</span>  <span style=color:#ae81ff>6827707575</span>        push dword 0x75757027
</span></span><span style=display:flex><span><span style=color:#ae81ff>00000049</span>  <span style=color:#ae81ff>6820242427</span>        push dword 0x27242420
</span></span><span style=display:flex><span>0000004E  <span style=color:#ae81ff>6879727675</span>        push dword 0x75767279
</span></span><span style=display:flex><span><span style=color:#ae81ff>00000053</span>  <span style=color:#ae81ff>6877737927</span>        push dword 0x27797377
</span></span><span style=display:flex><span><span style=color:#ae81ff>00000058</span>  <span style=color:#ae81ff>6824207477</span>        push dword 0x77742024
</span></span><span style=display:flex><span>0000005D  <span style=color:#ae81ff>6827207422</span>        push dword 0x22742027
</span></span><span style=display:flex><span><span style=color:#ae81ff>00000062</span>  <span style=color:#ae81ff>6825772078</span>        push dword 0x78207725
</span></span><span style=display:flex><span><span style=color:#ae81ff>00000067</span>  <span style=color:#ae81ff>6875727974</span>        push dword 0x74797275
</span></span><span style=display:flex><span>0000006C  <span style=color:#ae81ff>6875242372</span>        push dword 0x72232475
</span></span><span style=display:flex><span><span style=color:#ae81ff>00000071</span>  <span style=color:#ae81ff>6876272424</span>        push dword 0x24242776
</span></span><span style=display:flex><span><span style=color:#ae81ff>00000076</span>  <span style=color:#ae81ff>6822797773</span>        push dword 0x73777922
</span></span><span style=display:flex><span>0000007B  <span style=color:#ae81ff>6874797820</span>        push dword 0x20787974
</span></span><span style=display:flex><span><span style=color:#ae81ff>00000080</span>  <span style=color:#ae81ff>6825257674</span>        push dword 0x74762525
</span></span><span style=display:flex><span><span style=color:#ae81ff>00000085</span>  <span style=color:#ae81ff>6825747176</span>        push dword 0x76717425
</span></span><span style=display:flex><span>0000008A  <span style=color:#ae81ff>6827752323</span>        push dword 0x23237527
</span></span><span style=display:flex><span>0000008F  <span style=color:#ae81ff>6824222077</span>        push dword 0x77202224
</span></span><span style=display:flex><span><span style=color:#ae81ff>00000094</span>  <span style=color:#ae81ff>6822257378</span>        push dword 0x78732522
</span></span><span style=display:flex><span><span style=color:#ae81ff>00000099</span>  <span style=color:#ae81ff>6873237576</span>        push dword 0x76752373
</span></span><span style=display:flex><span>0000009E  <span style=color:#ae81ff>6873737525</span>        push dword 0x25757373
</span></span><span style=display:flex><span>000000A3  <span style=color:#ae81ff>54</span>                push esp
</span></span><span style=display:flex><span>000000A4  5E                pop esi
</span></span><span style=display:flex><span>000000A5  8BFE              mov edi,esi
</span></span><span style=display:flex><span>000000A7  8BD7              mov edx,edi
</span></span><span style=display:flex><span>000000A9  FC                cld
</span></span><span style=display:flex><span>000000AA  B980000000        mov ecx,0x80
</span></span><span style=display:flex><span>000000AF  BB41000000        mov ebx,0x41
</span></span><span style=display:flex><span>000000B4  31C0              xor eax,eax
</span></span><span style=display:flex><span>000000B6  <span style=color:#ae81ff>50</span>                push eax
</span></span><span style=display:flex><span>000000B7  AC                lodsb
</span></span><span style=display:flex><span>000000B8  33C3              xor eax,ebx
</span></span><span style=display:flex><span>000000BA  AA                stosb
</span></span><span style=display:flex><span>000000BB  E2FA              loop 0xb7
</span></span><span style=display:flex><span>000000BD  <span style=color:#ae81ff>54</span>                push esp
</span></span><span style=display:flex><span>000000BE  5E                pop esi
</span></span><span style=display:flex><span>000000BF  CC                int3
</span></span></code></pre></div><p>Now we have to edit the file before we can assemble it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ awk <span style=color:#e6db74>&#39;{$1=$2=&#34;&#34;; print $0}&#39;</span> shellcode.asm | sed <span style=color:#e6db74>&#39;s/^  //g&#39;</span> &gt; shellcode_edited.asm
</span></span></code></pre></div><p>Save diff to patch file <strong>shellcode.patch</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-patch data-lang=patch><span style=display:flex><span><span style=color:#f92672>--- shellcode.asm	2020-01-23 12:29:31.345434907 +0100
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ shellcode_diff.asm	2020-01-23 12:28:09.689429680 +0100
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -1,3 +1,5 @@
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>+global _start
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+_start:
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span> xor eax,eax
</span></span><span style=display:flex><span> push eax
</span></span><span style=display:flex><span> push dword 0x71757724
</span></span><span style=display:flex><span><span style=color:#75715e>@@ -41,10 +43,11 @@
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> mov ebx,0x41
</span></span><span style=display:flex><span> xor eax,eax
</span></span><span style=display:flex><span> push eax
</span></span><span style=display:flex><span><span style=color:#a6e22e>+decode:
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span> lodsb
</span></span><span style=display:flex><span> xor eax,ebx
</span></span><span style=display:flex><span> stosb
</span></span><span style=display:flex><span><span style=color:#f92672>-loop 0xb7
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+loop decode
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span> push esp
</span></span><span style=display:flex><span> pop esi
</span></span><span style=display:flex><span> int3
</span></span></code></pre></div><p>And apply the following patch. Then we can assemble it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ patch &lt; shellcode.patch
</span></span><span style=display:flex><span>$ nasm -f elf shellcode.asm
</span></span><span style=display:flex><span>$ ld -m elf_i386 -o key_ed shellcode.o
</span></span></code></pre></div><p>Finally let&rsquo;s find the <strong>secret key</strong>!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gdb ./key_ed
</span></span><span style=display:flex><span><span style=color:#66d9ef>$(</span>gdb<span style=color:#66d9ef>)</span> r
</span></span><span style=display:flex><span><span style=color:#66d9ef>$(</span>gdb<span style=color:#66d9ef>)</span> x/s $edx
</span></span><span style=display:flex><span>0xffffdbec:	<span style=color:#e6db74>&#34;224d2b47cd29eca6f4bbd507dd75589ac8627fee4eb34385d6a9fa5cea56628f8374aeeff14432f57ddc97ba1286a20ae5bbffac4ed5667447cb97ed4b8ae640&#34;</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.burso.eu/tags/offensive-security/>offensive-security</a></li><li><a href=https://www.burso.eu/tags/hacking/>hacking</a></li><li><a href=https://www.burso.eu/tags/ctf/>ctf</a></li></ul><nav class=paginav><a class=prev href=https://www.burso.eu/posts/citrix-vulnerability/><span class=title>« Prev Page</span><br><span>How find a vulnerable server on the internet?</span></a>
<a class=next href=https://www.burso.eu/posts/34c3-tuwat/><span class=title>Next Page »</span><br><span>Notes from #34c3</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share OSCE Prologue or How to get Secret key to CTP? on twitter" href="https://twitter.com/intent/tweet/?text=OSCE%20Prologue%20or%20How%20to%20get%20Secret%20key%20to%20CTP%3f&url=https%3a%2f%2fwww.burso.eu%2fposts%2fosce-prologue%2f&hashtags=offensive-security%2chacking%2cctf"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share OSCE Prologue or How to get Secret key to CTP? on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fwww.burso.eu%2fposts%2fosce-prologue%2f&title=OSCE%20Prologue%20or%20How%20to%20get%20Secret%20key%20to%20CTP%3f&summary=OSCE%20Prologue%20or%20How%20to%20get%20Secret%20key%20to%20CTP%3f&source=https%3a%2f%2fwww.burso.eu%2fposts%2fosce-prologue%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share OSCE Prologue or How to get Secret key to CTP? on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwww.burso.eu%2fposts%2fosce-prologue%2f&title=OSCE%20Prologue%20or%20How%20to%20get%20Secret%20key%20to%20CTP%3f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share OSCE Prologue or How to get Secret key to CTP? on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.burso.eu%2fposts%2fosce-prologue%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share OSCE Prologue or How to get Secret key to CTP? on whatsapp" href="https://api.whatsapp.com/send?text=OSCE%20Prologue%20or%20How%20to%20get%20Secret%20key%20to%20CTP%3f%20-%20https%3a%2f%2fwww.burso.eu%2fposts%2fosce-prologue%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share OSCE Prologue or How to get Secret key to CTP? on telegram" href="https://telegram.me/share/url?text=OSCE%20Prologue%20or%20How%20to%20get%20Secret%20key%20to%20CTP%3f&url=https%3a%2f%2fwww.burso.eu%2fposts%2fosce-prologue%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://www.burso.eu>.burso | blog about ctf & anything else</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>