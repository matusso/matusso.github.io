<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Reversing ELF | .burso | blog about ctf & anything else</title><meta name=keywords content="ctf,re,IDA,elfutils,tryhackme"><meta name=description content="Hi, today I would like to show you how to solve easy RE CTF and how to start with RE, my directory after finish all challenges looks following:
$ tree . ├── crackme_1 │ ├── crackme1 │ └── flag.txt ├── crackme_2 │ ├── crackme2 │ └── flag.txt ├── crackme_3 │ ├── crackme3 │ └── flag.txt ├── crackme_4 │ ├── crackme4 │ ├── flag.txt │ └── gdb_cmd ├── crackme_5 │ ├── crackme5 │ ├── flag."><meta name=author content="Matus Bursa"><link rel=canonical href=https://www.burso.eu/posts/reversing-elf/><link crossorigin=anonymous href=/assets/css/stylesheet.dc96e9e0118e5e264a03d68b104df6ae869cfb73c61f5f89dd91aeb16b0d8c03.css integrity="sha256-3Jbp4BGOXiZKA9aLEE32roac+3PGH1+J3ZGusWsNjAM=" rel="preload stylesheet" as=style><link rel=icon href=https://www.burso.eu/img/hacked.png><link rel=icon type=image/png sizes=16x16 href=https://www.burso.eu/img/hacked.png><link rel=icon type=image/png sizes=32x32 href=https://www.burso.eu/img/hacked.png><link rel=apple-touch-icon href=https://www.burso.eu/img/hacked.png><link rel=mask-icon href=https://www.burso.eu/img/hacked.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Reversing ELF"><meta property="og:description" content="Hi, today I would like to show you how to solve easy RE CTF and how to start with RE, my directory after finish all challenges looks following:
$ tree . ├── crackme_1 │ ├── crackme1 │ └── flag.txt ├── crackme_2 │ ├── crackme2 │ └── flag.txt ├── crackme_3 │ ├── crackme3 │ └── flag.txt ├── crackme_4 │ ├── crackme4 │ ├── flag.txt │ └── gdb_cmd ├── crackme_5 │ ├── crackme5 │ ├── flag."><meta property="og:type" content="article"><meta property="og:url" content="https://www.burso.eu/posts/reversing-elf/"><meta property="og:image" content="https://www.burso.eu/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-12-07T19:06:00+01:00"><meta property="article:modified_time" content="2020-12-07T19:06:00+01:00"><meta property="og:site_name" content=".burso"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.burso.eu/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Reversing ELF"><meta name=twitter:description content="Hi, today I would like to show you how to solve easy RE CTF and how to start with RE, my directory after finish all challenges looks following:
$ tree . ├── crackme_1 │ ├── crackme1 │ └── flag.txt ├── crackme_2 │ ├── crackme2 │ └── flag.txt ├── crackme_3 │ ├── crackme3 │ └── flag.txt ├── crackme_4 │ ├── crackme4 │ ├── flag.txt │ └── gdb_cmd ├── crackme_5 │ ├── crackme5 │ ├── flag."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://www.burso.eu/posts/"},{"@type":"ListItem","position":3,"name":"Reversing ELF","item":"https://www.burso.eu/posts/reversing-elf/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Reversing ELF","name":"Reversing ELF","description":"Hi, today I would like to show you how to solve easy RE CTF and how to start with RE, my directory after finish all challenges looks following:\n$ tree . ├── crackme_1 │ ├── crackme1 │ └── flag.txt ├── crackme_2 │ ├── crackme2 │ └── flag.txt ├── crackme_3 │ ├── crackme3 │ └── flag.txt ├── crackme_4 │ ├── crackme4 │ ├── flag.txt │ └── gdb_cmd ├── crackme_5 │ ├── crackme5 │ ├── flag.","keywords":["ctf","re","IDA","elfutils","tryhackme"],"articleBody":"Hi, today I would like to show you how to solve easy RE CTF and how to start with RE, my directory after finish all challenges looks following:\n$ tree . ├── crackme_1 │ ├── crackme1 │ └── flag.txt ├── crackme_2 │ ├── crackme2 │ └── flag.txt ├── crackme_3 │ ├── crackme3 │ └── flag.txt ├── crackme_4 │ ├── crackme4 │ ├── flag.txt │ └── gdb_cmd ├── crackme_5 │ ├── crackme5 │ ├── flag.txt │ ├── preload.c │ └── preload.so ├── crackme_6 │ ├── crackme6 │ └── flag.txt ├── crackme_7 │ ├── crackme7 │ └── flag.txt └── crackme_8 ├── crackme8 ├── flag.txt └── gdb_cmd Before we start I would recommend following software\nr2 gdb And you can find this game here. Now let’s look deeper on each of the challenge.\ncrackme_1 $ file crackme1 crackme1: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=672f525a7ad3c33f190c060c09b11e9ffd007f34, not stripped Okay, file is ELF, now we try to run it.\n$ ./crackme1 flag{not_that_kind_of_elf} :) It is enough to run it, nothing special so far.\ncrackme_2 $ file crackme2 crackme2: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=b799eb348f3df15f6b08b3c37f8feb269a60aba7, not stripped $ ./crackme2 Usage: ./crackme2 password $ ./crackme2 aaa Access denied. Let’s look strings in binary\n$ strings crackme2 /lib/ld-linux.so.2 libc.so.6 _IO_stdin_used puts printf memset strcmp ... Usage: %s password super_secret_password ... .got.plt .data .bss .comment Nice, we probably have password, let’s try it\n$ ./crackme2 super_secret_password Access granted. flag{if_i_submit_this_flag_then_i_will_get_points} Great, second flag is ours.\ncrackme_3 $ file crackme3 crackme3: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.24, BuildID[sha1]=4cf7250afb50109f0f1a01cc543fbf5ba6204a73, stripped $ strings crackme3 /lib/ld-linux.so.2 __gmon_start__ libc.so.6 _IO_stdin_used puts strlen malloc ... Usage: %s PASSWORD malloc failed ZjByX3kwdXJfNWVjMG5kX2xlNTVvbl91bmJhc2U2NF80bGxfN2gzXzdoMW5nNQ== Correct password! Come on, even my aunt Mildred got this one! ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/ ... .got.plt .data .bss .comment There is a string encoded by base64\n$ echo \"ZjByX3kwdXJfNWVjMG5kX2xlNTVvbl91bmJhc2U2NF80bGxfN2gzXzdoMW5nNQ==\" | base64 -d f0r_y0ur_5ec0nd_le55on_unbase64_4ll_7h3_7h1ng5 Just couple of seconds and thirdth flag is on our side.\ncrackme_4 $ file crackme4 crackme4: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.24, BuildID[sha1]=862ee37793af334043b423ba50ec91cfa132260a, not stripped $ strings crackme4 /lib64/ld-linux-x86-64.so.2 libc.so.6 puts ... password OK password \"%s\" not OK Usage : %s password This time the string is hidden and we used strcmp ... Nothing special between strings, but we know, binary is using strcmp to compare “passwords”\n$ ./crackme4 Usage : ./crackme4 password This time the string is hidden and we used strcmp $ ./crackme4 AAA password \"AAA\" not OK Try to disassemble it and find place, where strcmp is called.\n$ objdump -D crackme4 | grep call | grep strcmp 4006d5: e8 46 fe ff ff callq 400520 Prepare gdb_cmd file with following content:\nbreak * 0x4006D5 run aaa x/s $rax Let’s start gdb with commands from file gdb_cmd\n$ gdb -x gdb_cmd ./crackme4 GNU gdb (GDB) 10.1 ... Undefined command: \"import\". Try \"help\". Reading symbols from ./crackme4... (No debugging symbols found in ./crackme4) Breakpoint 1 at 0x4006d5 Breakpoint 1, 0x00000000004006d5 in compare_pwd () 0x7fffffffe440: \"my_m0r3_secur3_pwd\" (gdb) We can verify this password with the application crackme4\n$ ./crackme4 my_m0r3_secur3_pwd password OK crackme_5 $ file crackme5 crackme5: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=a426dcf8ed3de8cb02f3ee4f38ee36b4ed568519, not stripped Again nothing special in strings so I will not give you output of strings command here now. Let’s look into function names which application is using\n$ gdb crackme5 GNU gdb (GDB) 10.1 ... Reading symbols from crackme5... (No debugging symbols found in crackme5) (gdb) info functions All defined functions: Non-debugging symbols: 0x0000000000400528 _init 0x0000000000400560 strncmp@plt 0x0000000000400570 puts@plt 0x0000000000400580 strlen@plt 0x0000000000400590 __stack_chk_fail@plt 0x00000000004005a0 __libc_start_main@plt 0x00000000004005b0 atoi@plt 0x00000000004005c0 __isoc99_scanf@plt 0x00000000004005d0 __gmon_start__@plt 0x00000000004005e0 _start 0x0000000000400610 deregister_tm_clones 0x0000000000400650 register_tm_clones 0x0000000000400690 __do_global_dtors_aux 0x00000000004006b0 frame_dummy 0x00000000004006d6 strcmp_ 0x0000000000400773 main 0x000000000040086e check 0x00000000004008d0 __libc_csu_init 0x0000000000400940 __libc_csu_fini 0x0000000000400944 _fini Okay, looks like strncmp is using for comparing password and your input, so we can override this function, let’s create preload.c file with following content:\n#define _GNU_SOURCE #include #include int strncmp(const char *s1, const char *s2, size_t n) { printf(\"S1: [%s], S2: [%s]\\n\", s1, s2); int (*original_strcmp)(const char*, const char*, size_t); original_strcmp = dlsym(RTLD_NEXT, \"strcmp\"); return (*original_strcmp)(s1, s2, n); } Now compile our code and run crackme5 with following parameters to load our library:\n$ gcc -Wall -fPIC -shared -o preload.so preload.c -ldl $ LD_PRELOAD=./preload.so ./crackme5 Enter your input: AAA S1: [AAA], S2: [OfdlDSA|3tXb32~X3tX@sX`4tXtz] Always dig deeper Nice :) we have another flag.\ncrackme_6 $ file crackme6 crackme6: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.24, BuildID[sha1]=022f1a8e479cab9f7263af75bcdbb328bda7f291, not stripped When we look into functions, we can see function called my_secure_test there.\n$ gdb ./crackme6 GNU gdb (GDB) 10.1 ... Reading symbols from ./crackme6... (No debugging symbols found in ./crackme6) (gdb) info functions All defined functions: Non-debugging symbols: 0x0000000000400418 _init 0x0000000000400450 puts@plt 0x0000000000400460 printf@plt 0x0000000000400470 __libc_start_main@plt 0x0000000000400480 __gmon_start__@plt 0x0000000000400490 _start 0x00000000004004c0 deregister_tm_clones 0x00000000004004f0 register_tm_clones 0x0000000000400530 __do_global_dtors_aux 0x0000000000400550 frame_dummy 0x000000000040057d my_secure_test 0x00000000004006d1 compare_pwd 0x0000000000400711 main 0x0000000000400760 __libc_csu_init 0x00000000004007d0 __libc_csu_fini 0x00000000004007d4 _fini This function is starting on address 0x040057d and finishing on address 0x04006d0, so let’s find all cmp instructions between these two addresses\n$ objdump -D crackme6 | egrep -e \"4005|4006\" | grep \"cmp \" 400597: 3c 31 cmp $0x31,%al 4005bf: 3c 33 cmp $0x33,%al 4005e7: 3c 33 cmp $0x33,%al 40060f: 3c 37 cmp $0x37,%al 400637: 3c 5f cmp $0x5f,%al 40065f: 3c 70 cmp $0x70,%al 400684: 3c 77 cmp $0x77,%al 4006a9: 3c 64 cmp $0x64,%al When we convert hex values to characters in ASCII table, we get 1337_pwd\n$ ./crackme6 1337_pwd password OK crackme_7 Now we can look on crackme7 binary\n$ file crackme7 crackme7: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=7ee4206d91718e7b0bef16a7c03f8fa49c4a39e7, not stripped Again, nothing special in binary strings, so we look into functions\n$ r2 crackme7 -- Mess with the best, Die like the rest [0x080483c0]\u003e aaa ... [0x080483c0]\u003e afl 0x080483c0 1 33 entry0 0x08048380 1 6 sym.imp.__libc_start_main 0x08048400 4 43 sym.deregister_tm_clones 0x08048430 4 53 sym.register_tm_clones 0x08048470 3 30 sym.__do_global_dtors_aux 0x08048490 4 43 -\u003e 40 entry.init0 0x080486a6 4 149 sym.giveFlag 0x080487a0 1 2 sym.__libc_csu_fini 0x080483f0 1 4 sym.__x86.get_pc_thunk.bx 0x080487a4 1 20 sym._fini 0x08048740 4 93 sym.__libc_csu_init 0x080484bb 20 491 main 0x08048324 3 35 sym._init 0x08048360 1 6 sym.imp.printf 0x08048370 1 6 sym.imp.puts 0x08048390 1 6 sym.imp.memset 0x080483a0 1 6 sym.imp.__isoc99_scanf Basicaly we want to call function sym.giveFlag on address 0x080486a6, so we need to find where the function is called\n[0x080483c0]\u003e axt sym.giveFlag main 0x804867c [CALL] call sym.giveFlag Okay, so function is called in function main\n[0x080483c0]\u003e pdf @ main you can see compare cmp eax, 0x7a69 instruction near before calling giveFlag function and again when we convert 7a69 hex to decimal, then we have a result.\n$ ./crackme7 Menu: [1] Say hello [2] Add numbers [3] Quit [\u003e] 31337 Wow such h4x0r! flag{much_reversing_very_ida_wow} crackme_8 Okay, now we have last one so let’s get basic informations\n$ file crackme8 crackme8: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=fef76e38b5ff92ed0d08870ac523f9f3f8925a40, not stripped $ ./crackme8 Usage: ./crackme8 password $ ./crackme8 abcdef Access denied. $ r2 crackme8 -- 256 colors ought to be enough for anybody [0x080483a0]\u003e aaa ... [0x080483a0]\u003e afl 0x080483a0 1 33 entry0 0x08048360 1 6 sym.imp.__libc_start_main 0x080483e0 4 43 sym.deregister_tm_clones 0x08048410 4 53 sym.register_tm_clones 0x08048450 3 30 sym.__do_global_dtors_aux 0x08048470 4 43 -\u003e 40 entry.init0 0x08048524 4 149 sym.giveFlag 0x08048620 1 2 sym.__libc_csu_fini 0x080483d0 1 4 sym.__x86.get_pc_thunk.bx 0x08048624 1 20 sym._fini 0x080485c0 4 93 sym.__libc_csu_init 0x0804849b 6 137 main 0x08048300 3 35 sym._init 0x08048340 1 6 sym.imp.printf 0x08048350 1 6 sym.imp.puts 0x08048370 1 6 sym.imp.memset 0x08048380 1 6 sym.imp.atoi [0x080483a0]\u003e axt sym.giveFlag main 0x8048512 [CALL] call sym.giveFlag [0x080483a0]\u003e pdf @ main You can see on address 0x080484e4 instruction cmp eax, 0xcafef00d so, now we can prepare gdb commands. Create file called gdb_cmd with following content:\nbreak * 0x080484E4 r 1 set $eax=3405705229 c Btw, decimal value 3405705229 in $eax register is converted from cafef00d hex. Now, we can run binary as follows:\n$ gdb -x gdb_cmd ./crackme8 GNU gdb (GDB) 10.1 ... Undefined command: \"import\". Try \"help\". Reading symbols from ./crackme8... (No debugging symbols found in ./crackme8) Breakpoint 1 at 0x80484e4 Breakpoint 1, 0x080484e4 in main () Access granted. flag{at_least_this_cafe_wont_leak_your_credit_card_numbers} [Inferior 1 (process 1537622) exited normally] (gdb) Done, we have the last flag we need. h4ppy r3v3r5e! ;)\n","wordCount":"1397","inLanguage":"en","datePublished":"2020-12-07T19:06:00+01:00","dateModified":"2020-12-07T19:06:00+01:00","author":{"@type":"Person","name":"Matus Bursa"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.burso.eu/posts/reversing-elf/"},"publisher":{"@type":"Organization","name":".burso | blog about ctf \u0026 anything else","logo":{"@type":"ImageObject","url":"https://www.burso.eu/img/hacked.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.burso.eu accesskey=h title="/ (Alt + H)"><img src=https://www.burso.eu/img/hacked.png alt aria-label=logo height=35>/</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.burso.eu/archives/ title=archives><span>archives</span></a></li><li><a href=https://www.burso.eu/categories/ title=categories><span>categories</span></a></li><li><a href=https://www.burso.eu/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://www.burso.eu/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://www.burso.eu>Home</a>&nbsp;»&nbsp;<a href=https://www.burso.eu/posts/>Posts</a></div><h1 class=post-title>Reversing ELF</h1><div class=post-meta><span title='2020-12-07 19:06:00 +0100 CET'>December 7, 2020</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Matus Bursa&nbsp;|&nbsp;<a href=https://github.com/matusso/website/edit/master/content//posts/reversing-elf.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>Hi,
today I would like to show you how to solve easy RE CTF and how to start with RE,
my directory after finish all challenges looks following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ tree
</span></span><span style=display:flex><span>.
</span></span><span style=display:flex><span>├── crackme_1
</span></span><span style=display:flex><span>│   ├── crackme1
</span></span><span style=display:flex><span>│   └── flag.txt
</span></span><span style=display:flex><span>├── crackme_2
</span></span><span style=display:flex><span>│   ├── crackme2
</span></span><span style=display:flex><span>│   └── flag.txt
</span></span><span style=display:flex><span>├── crackme_3
</span></span><span style=display:flex><span>│   ├── crackme3
</span></span><span style=display:flex><span>│   └── flag.txt
</span></span><span style=display:flex><span>├── crackme_4
</span></span><span style=display:flex><span>│   ├── crackme4
</span></span><span style=display:flex><span>│   ├── flag.txt
</span></span><span style=display:flex><span>│   └── gdb_cmd
</span></span><span style=display:flex><span>├── crackme_5
</span></span><span style=display:flex><span>│   ├── crackme5
</span></span><span style=display:flex><span>│   ├── flag.txt
</span></span><span style=display:flex><span>│   ├── preload.c
</span></span><span style=display:flex><span>│   └── preload.so
</span></span><span style=display:flex><span>├── crackme_6
</span></span><span style=display:flex><span>│   ├── crackme6
</span></span><span style=display:flex><span>│   └── flag.txt
</span></span><span style=display:flex><span>├── crackme_7
</span></span><span style=display:flex><span>│   ├── crackme7
</span></span><span style=display:flex><span>│   └── flag.txt
</span></span><span style=display:flex><span>└── crackme_8
</span></span><span style=display:flex><span>    ├── crackme8
</span></span><span style=display:flex><span>    ├── flag.txt
</span></span><span style=display:flex><span>    └── gdb_cmd
</span></span></code></pre></div><p>Before we start I would recommend following software</p><ul><li><a href>r2</a></li><li><a href>gdb</a></li></ul><p>And you can find this game <a href=https://tryhackme.com/room/reverselfiles>here</a>.
Now let&rsquo;s look deeper on each of the challenge.</p><h3 id=crackme_1>crackme_1<a hidden class=anchor aria-hidden=true href=#crackme_1>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ file crackme1
</span></span><span style=display:flex><span>crackme1: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=672f525a7ad3c33f190c060c09b11e9ffd007f34, not stripped
</span></span></code></pre></div><p>Okay, file is <a href=https://en.wikipedia.org/wiki/Executable_and_Linkable_Format>ELF</a>, now we try to run it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ ./crackme1
</span></span><span style=display:flex><span>flag{not_that_kind_of_elf}
</span></span></code></pre></div><p>:) It is enough to run it, nothing special so far.</p><h3 id=crackme_2>crackme_2<a hidden class=anchor aria-hidden=true href=#crackme_2>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ file crackme2
</span></span><span style=display:flex><span>crackme2: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=b799eb348f3df15f6b08b3c37f8feb269a60aba7, not stripped
</span></span><span style=display:flex><span>$ ./crackme2
</span></span><span style=display:flex><span>Usage: ./crackme2 password
</span></span><span style=display:flex><span>$ ./crackme2 aaa
</span></span><span style=display:flex><span>Access denied.
</span></span></code></pre></div><p>Let&rsquo;s look strings in binary</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ strings crackme2
</span></span><span style=display:flex><span>/lib/ld-linux.so.2
</span></span><span style=display:flex><span>libc.so.6
</span></span><span style=display:flex><span>_IO_stdin_used
</span></span><span style=display:flex><span>puts
</span></span><span style=display:flex><span>printf
</span></span><span style=display:flex><span>memset
</span></span><span style=display:flex><span>strcmp
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>Usage: %s password
</span></span><span style=display:flex><span>super_secret_password
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>.got.plt
</span></span><span style=display:flex><span>.data
</span></span><span style=display:flex><span>.bss
</span></span><span style=display:flex><span>.comment
</span></span></code></pre></div><p>Nice, we probably have password, let&rsquo;s try it</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ ./crackme2 super_secret_password
</span></span><span style=display:flex><span>Access granted.
</span></span><span style=display:flex><span>flag{if_i_submit_this_flag_then_i_will_get_points}
</span></span></code></pre></div><p>Great, second flag is ours.</p><h3 id=crackme_3>crackme_3<a hidden class=anchor aria-hidden=true href=#crackme_3>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ file crackme3
</span></span><span style=display:flex><span>crackme3: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.24, BuildID[sha1]=4cf7250afb50109f0f1a01cc543fbf5ba6204a73, stripped
</span></span><span style=display:flex><span>$ strings crackme3
</span></span><span style=display:flex><span>/lib/ld-linux.so.2
</span></span><span style=display:flex><span>__gmon_start__
</span></span><span style=display:flex><span>libc.so.6
</span></span><span style=display:flex><span>_IO_stdin_used
</span></span><span style=display:flex><span>puts
</span></span><span style=display:flex><span>strlen
</span></span><span style=display:flex><span>malloc
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>Usage: %s PASSWORD
</span></span><span style=display:flex><span>malloc failed
</span></span><span style=display:flex><span>ZjByX3kwdXJfNWVjMG5kX2xlNTVvbl91bmJhc2U2NF80bGxfN2gzXzdoMW5nNQ==
</span></span><span style=display:flex><span>Correct password!
</span></span><span style=display:flex><span>Come on, even my aunt Mildred got this one!
</span></span><span style=display:flex><span>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>.got.plt
</span></span><span style=display:flex><span>.data
</span></span><span style=display:flex><span>.bss
</span></span><span style=display:flex><span>.comment
</span></span></code></pre></div><p>There is a string encoded by <a href=https://en.wikipedia.org/wiki/Base64>base64</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ echo &#34;ZjByX3kwdXJfNWVjMG5kX2xlNTVvbl91bmJhc2U2NF80bGxfN2gzXzdoMW5nNQ==&#34; | base64 -d
</span></span><span style=display:flex><span>f0r_y0ur_5ec0nd_le55on_unbase64_4ll_7h3_7h1ng5
</span></span></code></pre></div><p>Just couple of seconds and thirdth flag is on our side.</p><h3 id=crackme_4>crackme_4<a hidden class=anchor aria-hidden=true href=#crackme_4>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ file crackme4
</span></span><span style=display:flex><span>crackme4: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.24, BuildID[sha1]=862ee37793af334043b423ba50ec91cfa132260a, not stripped
</span></span><span style=display:flex><span>$ strings crackme4
</span></span><span style=display:flex><span>/lib64/ld-linux-x86-64.so.2
</span></span><span style=display:flex><span>libc.so.6
</span></span><span style=display:flex><span>puts
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>password OK
</span></span><span style=display:flex><span>password &#34;%s&#34; not OK
</span></span><span style=display:flex><span>Usage : %s password
</span></span><span style=display:flex><span>This time the string is hidden and we used strcmp
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>Nothing special between strings, but we know, binary is using strcmp to compare &ldquo;passwords&rdquo;</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ ./crackme4
</span></span><span style=display:flex><span>Usage : ./crackme4 password
</span></span><span style=display:flex><span>This time the string is hidden and we used strcmp
</span></span><span style=display:flex><span>$ ./crackme4 AAA
</span></span><span style=display:flex><span>password &#34;AAA&#34; not OK
</span></span></code></pre></div><p>Try to disassemble it and find place, where <strong>strcmp</strong> is called.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ objdump -D crackme4 | grep call | grep strcmp
</span></span><span style=display:flex><span>  4006d5:       e8 46 fe ff ff          callq  400520 &lt;strcmp@plt&gt;
</span></span></code></pre></div><p>Prepare <strong>gdb_cmd</strong> file with following content:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>break * 0x4006D5
</span></span><span style=display:flex><span>run aaa
</span></span><span style=display:flex><span>x/s $rax
</span></span></code></pre></div><p>Let&rsquo;s start gdb with commands from file <strong>gdb_cmd</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ gdb -x gdb_cmd ./crackme4
</span></span><span style=display:flex><span>GNU gdb (GDB) 10.1
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>Undefined command: &#34;import&#34;.  Try &#34;help&#34;.
</span></span><span style=display:flex><span>Reading symbols from ./crackme4...
</span></span><span style=display:flex><span>(No debugging symbols found in ./crackme4)
</span></span><span style=display:flex><span>Breakpoint 1 at 0x4006d5
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Breakpoint 1, 0x00000000004006d5 in compare_pwd ()
</span></span><span style=display:flex><span>0x7fffffffe440: &#34;my_m0r3_secur3_pwd&#34;
</span></span><span style=display:flex><span>(gdb)
</span></span></code></pre></div><p>We can verify this password with the application <strong>crackme4</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ ./crackme4 my_m0r3_secur3_pwd
</span></span><span style=display:flex><span>password OK
</span></span></code></pre></div><h3 id=crackme_5>crackme_5<a hidden class=anchor aria-hidden=true href=#crackme_5>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ file crackme5
</span></span><span style=display:flex><span>crackme5: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=a426dcf8ed3de8cb02f3ee4f38ee36b4ed568519, not stripped
</span></span></code></pre></div><p>Again nothing special in strings so I will not give you output of strings command here now.
Let&rsquo;s look into function names which application is using</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ gdb crackme5
</span></span><span style=display:flex><span>GNU gdb (GDB) 10.1
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>Reading symbols from crackme5...
</span></span><span style=display:flex><span>(No debugging symbols found in crackme5)
</span></span><span style=display:flex><span>(gdb) info functions
</span></span><span style=display:flex><span>All defined functions:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Non-debugging symbols:
</span></span><span style=display:flex><span>0x0000000000400528  _init
</span></span><span style=display:flex><span>0x0000000000400560  strncmp@plt
</span></span><span style=display:flex><span>0x0000000000400570  puts@plt
</span></span><span style=display:flex><span>0x0000000000400580  strlen@plt
</span></span><span style=display:flex><span>0x0000000000400590  __stack_chk_fail@plt
</span></span><span style=display:flex><span>0x00000000004005a0  __libc_start_main@plt
</span></span><span style=display:flex><span>0x00000000004005b0  atoi@plt
</span></span><span style=display:flex><span>0x00000000004005c0  __isoc99_scanf@plt
</span></span><span style=display:flex><span>0x00000000004005d0  __gmon_start__@plt
</span></span><span style=display:flex><span>0x00000000004005e0  _start
</span></span><span style=display:flex><span>0x0000000000400610  deregister_tm_clones
</span></span><span style=display:flex><span>0x0000000000400650  register_tm_clones
</span></span><span style=display:flex><span>0x0000000000400690  __do_global_dtors_aux
</span></span><span style=display:flex><span>0x00000000004006b0  frame_dummy
</span></span><span style=display:flex><span>0x00000000004006d6  strcmp_
</span></span><span style=display:flex><span>0x0000000000400773  main
</span></span><span style=display:flex><span>0x000000000040086e  check
</span></span><span style=display:flex><span>0x00000000004008d0  __libc_csu_init
</span></span><span style=display:flex><span>0x0000000000400940  __libc_csu_fini
</span></span><span style=display:flex><span>0x0000000000400944  _fini
</span></span></code></pre></div><p>Okay, looks like <strong>strncmp</strong> is using for comparing password and your input, so we can override this function,
let&rsquo;s create <strong>preload.c</strong> file with following content:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>#define _GNU_SOURCE
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>#include &lt;stdio.h&gt;
</span></span><span style=display:flex><span>#include &lt;dlfcn.h&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>int strncmp(const char *s1, const char *s2, size_t n) {
</span></span><span style=display:flex><span>    printf(&#34;S1: [%s], S2: [%s]\n&#34;, s1, s2);
</span></span><span style=display:flex><span>    int (*original_strcmp)(const char*, const char*, size_t);
</span></span><span style=display:flex><span>    original_strcmp = dlsym(RTLD_NEXT, &#34;strcmp&#34;);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    return (*original_strcmp)(s1, s2, n);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Now compile our code and run <strong>crackme5</strong> with following parameters to load our library:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ gcc -Wall -fPIC -shared -o preload.so preload.c -ldl
</span></span><span style=display:flex><span>$ LD_PRELOAD=./preload.so ./crackme5
</span></span><span style=display:flex><span>Enter your input:
</span></span><span style=display:flex><span>AAA
</span></span><span style=display:flex><span>S1: [AAA], S2: [OfdlDSA|3tXb32~X3tX@sX`4tXtz]
</span></span><span style=display:flex><span>Always dig deeper
</span></span></code></pre></div><p>Nice :) we have another flag.</p><h3 id=crackme_6>crackme_6<a hidden class=anchor aria-hidden=true href=#crackme_6>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ file crackme6
</span></span><span style=display:flex><span>crackme6: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.24, BuildID[sha1]=022f1a8e479cab9f7263af75bcdbb328bda7f291, not stripped
</span></span></code></pre></div><p>When we look into functions, we can see function called <strong>my_secure_test</strong> there.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ gdb ./crackme6
</span></span><span style=display:flex><span>GNU gdb (GDB) 10.1
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>Reading symbols from ./crackme6...
</span></span><span style=display:flex><span>(No debugging symbols found in ./crackme6)
</span></span><span style=display:flex><span>(gdb) info functions
</span></span><span style=display:flex><span>All defined functions:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Non-debugging symbols:
</span></span><span style=display:flex><span>0x0000000000400418  _init
</span></span><span style=display:flex><span>0x0000000000400450  puts@plt
</span></span><span style=display:flex><span>0x0000000000400460  printf@plt
</span></span><span style=display:flex><span>0x0000000000400470  __libc_start_main@plt
</span></span><span style=display:flex><span>0x0000000000400480  __gmon_start__@plt
</span></span><span style=display:flex><span>0x0000000000400490  _start
</span></span><span style=display:flex><span>0x00000000004004c0  deregister_tm_clones
</span></span><span style=display:flex><span>0x00000000004004f0  register_tm_clones
</span></span><span style=display:flex><span>0x0000000000400530  __do_global_dtors_aux
</span></span><span style=display:flex><span>0x0000000000400550  frame_dummy
</span></span><span style=display:flex><span>0x000000000040057d  my_secure_test
</span></span><span style=display:flex><span>0x00000000004006d1  compare_pwd
</span></span><span style=display:flex><span>0x0000000000400711  main
</span></span><span style=display:flex><span>0x0000000000400760  __libc_csu_init
</span></span><span style=display:flex><span>0x00000000004007d0  __libc_csu_fini
</span></span><span style=display:flex><span>0x00000000004007d4  _fini
</span></span></code></pre></div><p>This function is starting on address <code>0x040057d</code> and finishing on address <code>0x04006d0</code>,
so let&rsquo;s find all <code>cmp</code> instructions between these two addresses</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ objdump -D crackme6  | egrep -e &#34;4005|4006&#34; | grep &#34;cmp &#34;
</span></span><span style=display:flex><span>  400597:       3c 31                   cmp    $0x31,%al
</span></span><span style=display:flex><span>  4005bf:       3c 33                   cmp    $0x33,%al
</span></span><span style=display:flex><span>  4005e7:       3c 33                   cmp    $0x33,%al
</span></span><span style=display:flex><span>  40060f:       3c 37                   cmp    $0x37,%al
</span></span><span style=display:flex><span>  400637:       3c 5f                   cmp    $0x5f,%al
</span></span><span style=display:flex><span>  40065f:       3c 70                   cmp    $0x70,%al
</span></span><span style=display:flex><span>  400684:       3c 77                   cmp    $0x77,%al
</span></span><span style=display:flex><span>  4006a9:       3c 64                   cmp    $0x64,%al
</span></span></code></pre></div><p>When we convert hex values to characters in <a href=https://www.asciitable.com/>ASCII table</a>, we get <strong>1337_pwd</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ ./crackme6 1337_pwd
</span></span><span style=display:flex><span>password OK
</span></span></code></pre></div><h3 id=crackme_7>crackme_7<a hidden class=anchor aria-hidden=true href=#crackme_7>#</a></h3><p>Now we can look on <strong>crackme7</strong> binary</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ file crackme7
</span></span><span style=display:flex><span>crackme7: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=7ee4206d91718e7b0bef16a7c03f8fa49c4a39e7, not stripped
</span></span></code></pre></div><p>Again, nothing special in binary strings, so we look into functions</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ r2 crackme7
</span></span><span style=display:flex><span> -- Mess with the best, Die like the rest
</span></span><span style=display:flex><span>[0x080483c0]&gt; aaa
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>[0x080483c0]&gt; afl
</span></span><span style=display:flex><span>0x080483c0    1 33           entry0
</span></span><span style=display:flex><span>0x08048380    1 6            sym.imp.__libc_start_main
</span></span><span style=display:flex><span>0x08048400    4 43           sym.deregister_tm_clones
</span></span><span style=display:flex><span>0x08048430    4 53           sym.register_tm_clones
</span></span><span style=display:flex><span>0x08048470    3 30           sym.__do_global_dtors_aux
</span></span><span style=display:flex><span>0x08048490    4 43   -&gt; 40   entry.init0
</span></span><span style=display:flex><span>0x080486a6    4 149          sym.giveFlag
</span></span><span style=display:flex><span>0x080487a0    1 2            sym.__libc_csu_fini
</span></span><span style=display:flex><span>0x080483f0    1 4            sym.__x86.get_pc_thunk.bx
</span></span><span style=display:flex><span>0x080487a4    1 20           sym._fini
</span></span><span style=display:flex><span>0x08048740    4 93           sym.__libc_csu_init
</span></span><span style=display:flex><span>0x080484bb   20 491          main
</span></span><span style=display:flex><span>0x08048324    3 35           sym._init
</span></span><span style=display:flex><span>0x08048360    1 6            sym.imp.printf
</span></span><span style=display:flex><span>0x08048370    1 6            sym.imp.puts
</span></span><span style=display:flex><span>0x08048390    1 6            sym.imp.memset
</span></span><span style=display:flex><span>0x080483a0    1 6            sym.imp.__isoc99_scanf
</span></span></code></pre></div><p>Basicaly we want to call function <strong>sym.giveFlag</strong> on address <code>0x080486a6</code>,
so we need to find where the function is called</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>[0x080483c0]&gt; axt sym.giveFlag
</span></span><span style=display:flex><span>main 0x804867c [CALL] call sym.giveFlag
</span></span></code></pre></div><p>Okay, so function is called in function <strong>main</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>[0x080483c0]&gt; pdf @ main
</span></span></code></pre></div><p><img loading=lazy src=/img/reverselfiles/crackme7.png alt="reverse2 #1"></p><p>you can see compare <code>cmp eax, 0x7a69</code>
instruction near before calling <strong>giveFlag</strong> function
and again when we convert <code>7a69</code> hex to decimal,
then we have a <a href=https://www.hexdictionary.com/hex/7A69>result</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ ./crackme7
</span></span><span style=display:flex><span>Menu:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[1] Say hello
</span></span><span style=display:flex><span>[2] Add numbers
</span></span><span style=display:flex><span>[3] Quit
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[&gt;] 31337
</span></span><span style=display:flex><span>Wow such h4x0r!
</span></span><span style=display:flex><span>flag{much_reversing_very_ida_wow}
</span></span></code></pre></div><h3 id=crackme_8>crackme_8<a hidden class=anchor aria-hidden=true href=#crackme_8>#</a></h3><p>Okay, now we have last one so let&rsquo;s get basic informations</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ file crackme8
</span></span><span style=display:flex><span>crackme8: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=fef76e38b5ff92ed0d08870ac523f9f3f8925a40, not stripped
</span></span><span style=display:flex><span>$ ./crackme8
</span></span><span style=display:flex><span>Usage: ./crackme8 password
</span></span><span style=display:flex><span>$ ./crackme8 abcdef
</span></span><span style=display:flex><span>Access denied.
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ r2 crackme8
</span></span><span style=display:flex><span> -- 256 colors ought to be enough for anybody
</span></span><span style=display:flex><span>[0x080483a0]&gt; aaa
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>[0x080483a0]&gt; afl
</span></span><span style=display:flex><span>0x080483a0    1 33           entry0
</span></span><span style=display:flex><span>0x08048360    1 6            sym.imp.__libc_start_main
</span></span><span style=display:flex><span>0x080483e0    4 43           sym.deregister_tm_clones
</span></span><span style=display:flex><span>0x08048410    4 53           sym.register_tm_clones
</span></span><span style=display:flex><span>0x08048450    3 30           sym.__do_global_dtors_aux
</span></span><span style=display:flex><span>0x08048470    4 43   -&gt; 40   entry.init0
</span></span><span style=display:flex><span>0x08048524    4 149          sym.giveFlag
</span></span><span style=display:flex><span>0x08048620    1 2            sym.__libc_csu_fini
</span></span><span style=display:flex><span>0x080483d0    1 4            sym.__x86.get_pc_thunk.bx
</span></span><span style=display:flex><span>0x08048624    1 20           sym._fini
</span></span><span style=display:flex><span>0x080485c0    4 93           sym.__libc_csu_init
</span></span><span style=display:flex><span>0x0804849b    6 137          main
</span></span><span style=display:flex><span>0x08048300    3 35           sym._init
</span></span><span style=display:flex><span>0x08048340    1 6            sym.imp.printf
</span></span><span style=display:flex><span>0x08048350    1 6            sym.imp.puts
</span></span><span style=display:flex><span>0x08048370    1 6            sym.imp.memset
</span></span><span style=display:flex><span>0x08048380    1 6            sym.imp.atoi
</span></span><span style=display:flex><span>[0x080483a0]&gt; axt sym.giveFlag
</span></span><span style=display:flex><span>main 0x8048512 [CALL] call sym.giveFlag
</span></span><span style=display:flex><span>[0x080483a0]&gt; pdf @ main
</span></span></code></pre></div><p><img loading=lazy src=/img/reverselfiles/crackme8.png alt="reverse2 #2"></p><p>You can see on address <code>0x080484e4</code> instruction <code>cmp eax, 0xcafef00d</code> so, now we can prepare <strong>gdb</strong> commands.
Create file called <em>gdb_cmd</em> with following content:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>break * 0x080484E4
</span></span><span style=display:flex><span>r 1
</span></span><span style=display:flex><span>set $eax=3405705229
</span></span><span style=display:flex><span>c
</span></span></code></pre></div><p>Btw, decimal value <strong>3405705229</strong> in <code>$eax</code> register is converted from <strong>cafef00d</strong> hex.
Now, we can run binary as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ gdb -x gdb_cmd ./crackme8
</span></span><span style=display:flex><span>GNU gdb (GDB) 10.1
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>Undefined command: &#34;import&#34;.  Try &#34;help&#34;.
</span></span><span style=display:flex><span>Reading symbols from ./crackme8...
</span></span><span style=display:flex><span>(No debugging symbols found in ./crackme8)
</span></span><span style=display:flex><span>Breakpoint 1 at 0x80484e4
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Breakpoint 1, 0x080484e4 in main ()
</span></span><span style=display:flex><span>Access granted.
</span></span><span style=display:flex><span>flag{at_least_this_cafe_wont_leak_your_credit_card_numbers}
</span></span><span style=display:flex><span>[Inferior 1 (process 1537622) exited normally]
</span></span><span style=display:flex><span>(gdb)
</span></span></code></pre></div><p>Done, we have the last flag we need.
h4ppy r3v3r5e! ;)</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.burso.eu/tags/ctf/>ctf</a></li><li><a href=https://www.burso.eu/tags/re/>re</a></li><li><a href=https://www.burso.eu/tags/ida/>IDA</a></li><li><a href=https://www.burso.eu/tags/elfutils/>elfutils</a></li><li><a href=https://www.burso.eu/tags/tryhackme/>tryhackme</a></li></ul><nav class=paginav><a class=prev href=https://www.burso.eu/posts/ret2win/><span class=title>« Prev</span><br><span>ret2win</span></a>
<a class=next href=https://www.burso.eu/posts/inclusion/><span class=title>Next »</span><br><span>Inclusion</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Reversing ELF on twitter" href="https://twitter.com/intent/tweet/?text=Reversing%20ELF&amp;url=https%3a%2f%2fwww.burso.eu%2fposts%2freversing-elf%2f&amp;hashtags=ctf%2cre%2cIDA%2celfutils%2ctryhackme"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Reversing ELF on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.burso.eu%2fposts%2freversing-elf%2f&amp;title=Reversing%20ELF&amp;summary=Reversing%20ELF&amp;source=https%3a%2f%2fwww.burso.eu%2fposts%2freversing-elf%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Reversing ELF on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwww.burso.eu%2fposts%2freversing-elf%2f&title=Reversing%20ELF"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Reversing ELF on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.burso.eu%2fposts%2freversing-elf%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Reversing ELF on whatsapp" href="https://api.whatsapp.com/send?text=Reversing%20ELF%20-%20https%3a%2f%2fwww.burso.eu%2fposts%2freversing-elf%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Reversing ELF on telegram" href="https://telegram.me/share/url?text=Reversing%20ELF&amp;url=https%3a%2f%2fwww.burso.eu%2fposts%2freversing-elf%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://www.burso.eu>.burso | blog about ctf & anything else</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>